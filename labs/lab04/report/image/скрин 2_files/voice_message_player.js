(()=>{"use strict";var t,e,i,s={25809:(t,e,i)=>{i(40851),i(96253),i(51876),i(59357),i(66108);var s=i(26271),a=i(2227),o="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",r='audio/mpeg; codecs="mp3"';class n{static isSupported(t){var e=document.createElement("audio");return!!e.canPlayType&&(!((t=t||r)!==r||!(s.browser.safari||s.browser.safari_mobile||s.browser.ios)||!s.browser.version.toString().startsWith("14"))||!!e.canPlayType(t).replace(/no/,""))}constructor(t){this.opts=t||{},this._trackOptions={},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}get type(){return"html5"}get loaded(){return!0}destroy(){}getPlayedTime(){for(var t=this._currentAudioEl.played,e=0,i=0;i<t.length;i++)e+=t.end(i)-t.start(i);return e}_setAudioNodeUrl(t,e){window.data&&window.data(t,"setUrlTimesetUrlTime",e==o?0:Date.now()),t.src=e}_createAudioNode(t){var e=new Audio,i=this;return this.opts.onBufferUpdate&&addEvent(e,"progress",(function(){i._currentAudioEl==e&&i.opts.onBufferUpdate(i.getCurrentBuffered());var t=e.buffered;1==t.length&&0==t.start(0)&&t.end(0)==e.duration&&(e._fullyLoaded=!0)})),addEvent(e,"stalled",(function(){i._currentAudioEl==e&&i._isInvalidDuration()&&i._currentAudioEl.currentTime>=i.duration-1&&i._currentAudioEl.dispatchEvent(new Event("ended"))})),this.opts.onProgressUpdate&&addEvent(e,"timeupdate",(function(){i._currentAudioEl==e&&i.opts.onProgressUpdate(i.getCurrentProgress())})),this.opts.onEnd&&addEvent(e,"ended",(function(){i._currentAudioEl==e&&i.opts.onEnd()})),this.opts.onSeeked&&addEvent(e,"seeked",(function(){i._currentAudioEl==e&&i.opts.onSeeked()})),this.opts.onSeek&&addEvent(e,"seeking",(function(){i._currentAudioEl==e&&i.opts.onSeek()})),addEvent(e,"error",(function(){i._prefetchAudioEl==e?i._prefetchAudioEl=i._createAudioNode():i._currentAudioEl==e&&i.opts.onFail&&i.opts.onFail()})),addEvent(e,"canplay",(function(){i._prefetchAudioEl,i._currentAudioEl==e&&(i.opts.onCanPlay&&i.opts.onCanPlay(),i._seekOnReady&&(i.seek(i._seekOnReady),i._seekOnReady=!1))})),t&&(this._setAudioNodeUrl(e,t),e.preload="auto",e.volume=this._volume||1,e.load()),this._audioNodes.push(e),e}onReady(t){t(!0)}prefetch(t){this._prefetchAudioEl&&this._setAudioNodeUrl(this._prefetchAudioEl,o),this._prefetchAudioEl=this._createAudioNode(t)}seek(t){var e=this._currentAudioEl;this.duration?e.currentTime=this.duration*t:this._seekOnReady=t}setVolume(t){void 0===t&&(t=this._currentAudioEl.volume),this._currentAudioEl.volume=t,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=t),this._volume=t}_isInvalidDuration(){var t=this._currentAudioEl;return isNaN(t.duration)||t.duration==1/0||0==t.duration}get duration(){var t=this._currentAudioEl,e=isNaN(t.duration)||t.duration==1/0?0:t.duration;return!e&&this._trackOptions.duration&&(e=parseInt(this._trackOptions.duration)),e}getCurrentProgress(){var t=this._currentAudioEl;return this.duration?Math.max(0,Math.min(1,t.currentTime/this.duration)):0}getCurrentBuffered(){var t=this._currentAudioEl;return t&&t.buffered.length?Math.min(1,t.buffered.end(0)/t.duration):0}isFullyLoaded(){return this._currentAudioEl._fullyLoaded}setUrl(t,e){var i=this._currentAudioEl;if(this._seekOnReady=!1,this._trackOptions={},e&&"object"==typeof e&&(this._trackOptions=e,e=e.callback),i.src==t)return this.opts.onCanPlay&&this.opts.onCanPlay(),e&&e(!0);if(this._prefetchAudioEl&&this._prefetchAudioEl.readyState>n.STATE_HAVE_NOTHING)if(this._prefetchAudioEl.src==t){this._currentAudioEl.pause(0),this._setAudioNodeUrl(this._currentAudioEl,o);var s=this;this._prefetchAudioEl.readyState>=n.STATE_HAVE_FUTURE_DATA&&setTimeout((function(){s.opts.onCanPlay&&s.opts.onCanPlay()})),i=this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=!1}else this._prefetchAudioEl.src&&this._setAudioNodeUrl(this._prefetchAudioEl,o);return i.src!=t&&(this._setAudioNodeUrl(i,t),i.load()),e&&e(!0)}play(t){this._prefetchAudioEl.src==t&&this._prefetchAudioEl.readyState>n.STATE_HAVE_NOTHING&&(this._setAudioNodeUrl(this._currentAudioEl,o),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=this._createAudioNode(),this.opts.onCanPlay&&this.opts.onCanPlay());var e=this._currentAudioEl;e.src&&(0,a.wrapAudioPlay)(e).catch((()=>{console.log("Audio: url set failed (html5 impl)")}))}pause(){var t=this._currentAudioEl;t.src&&t.pause()}stop(){var t=this._currentAudioEl;this._setAudioNodeUrl(t,o)}_setFadeVolumeInterval(t){if(t){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){var e=new Blob(["\n        var interval;\n        onmessage = function(e) {\n          clearInterval(interval);\n          if (e.data == 'start') {\n            interval = setInterval(function() { postMessage({}); }, 20);\n          }\n        }\n      "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(e))}catch(t){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=t,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(t,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)}fadeVolume(t,e){t=Math.max(0,Math.min(1,t));var i=this._currentAudioEl,s=0;if(s=t<i.volume?-.04:.001,Math.abs(t-i.volume)<=.001)return this._setFadeVolumeInterval(),e&&e();var a=i.volume;this._setFadeVolumeInterval(function(){s>0&&(s*=1.2),a+=s;if(s<0?a<=t:a>=t)return this.setVolume(t),this._setFadeVolumeInterval(),e&&e();this.setVolume(a)}.bind(this))}}n.STATE_HAVE_NOTHING=0,n.STATE_HAVE_FUTURE_DATA=3,n.HAVE_ENOUGH_DATA=4,n.AUDIO_EL_ID="ap_audio";var l=i(134),d=i(9720),h=i(40906);void 0===window.isTouch&&(window.isTouch=!1);class u{constructor(t,e){if(!t)throw new Error("No element was provided for Slider");t="string"==typeof t||"number"==typeof t?document.getElementById(t):t,this.options=e||{size:1},void 0===this.options.logfbase&&(this.options.logfbase=35),this.options.backValue=this.options.backValue||0;var i=100*this.options.backValue,s=`<div class="slider_slide">\n        <div class="slider_loading_bar" style="opacity: 0; display: none;"></div>\n        ${this.options.withBackLine?'<div class="slider_back" style="width:'+i+'%"></div>':""}\n        <div class="slider_amount ${this.options.useClippedPathProgress?"slider_amount--clipped":""}"></div>\n        <div class="slider_handler"></div>\n      </div>`;this._el=document.createElement("div"),this._el.innerHTML=s,this._el.id=t.getAttribute("id")||"",this._el.className="slider";var a=this;if(t.classList)for(var o=t.classList,r=0,n=o.length;r<n;r++)this._el.classList.add(o[r]);else this._el.className=t.className;(0,h.each)(this._el.attributes,(function(t,e){"id"==e.name&&"class"==e.name||a._el.setAttribute(e.name,e.value)})),t.parentNode.replaceChild(this._el,t),this._amountEl=this._el.querySelector(".slider_amount"),this._handlerEl=this._el.querySelector(".slider_handler"),this._slideEl=this._el.querySelector(".slider_slide"),this._backEl=this._el.querySelector(".slider_back"),this._progressEl=this._el.querySelector(".slider_loading_bar"),this.options.color&&(window.setStyle(this._amountEl,{backgroundColor:this.options.color}),window.setStyle(this._handlerEl,{backgroundColor:this.options.color})),this.options.backColor&&window.setStyle(this._slideEl,{backgroundColor:this.options.backColor}),this._el.classList.add("slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,d.debounce)(this._onValueChange,this.options.debounce)),!isTouch&&e.formatHint&&(addEvent(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),addEvent(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),addEvent(this._el,isTouch?"touchstart":"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),addEvent(this._el,"click",cancelEvent),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}toggleLoading(t){t=!!t,window.toggle(this._progressEl,t),window.setStyle(this._progressEl,"opacity",t?1:0)}destroy(){!isTouch&&this.options.formatHint&&(removeEvent(this._el,"mousemove",this._ev_onMouseOver),removeEvent(this._el,"mouseleave",this._ev_onMouseLeave),removeEvent(this._el,"mousedown",this._ev_onMouseDown));var t=window.re||window.remove;t(this._el),t(this._currHintEl)}_updateHint(t,e){if(!this._currHintEl){var i=document.createElement("div");i.className="slider_hint",i.id="slider_hint",this._currHintEl=i,this.options.hintClass&&this._currHintEl.classList.add(this.options.hintClass),this._el.appendChild(this._currHintEl)}var s=this._getPos(),a=Math.round((t.pageX||t.touches[0].pageX)-s[0]),o=this._width;if((a=e?Math.min(Math.max(0,a),o):a)>=0&&a<=o){var r=a/o;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,r):r;var n=this._currHintEl.getBoundingClientRect();window.setStyle(this._currHintEl,{left:this._slideEl.offsetLeft+a-(n.right-n.left)/2,top:this._slideEl.offsetTop-(n.bottom-n.top)-10}),!e&&this._toggleHint(!0)}else!e&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)}_toggleHint(t){this._currHintEl&&this._currHintEl.classList.toggle("visible",t)}_onMouseOver(t){u._currenSliderDrag||this._el.classList.contains("active")||this._updateHint(t)}_onMouseLeave(t){this._el.classList.contains("active")||this._toggleHint(!1)}get _width(){if(!this._widthCache){var t=this._el.getBoundingClientRect();this._widthCache=t.right-t.left}return this._widthCache}_onMouseDown(t){(0==t.button||t.touches)&&(delete cur._sliderMouseUpNowEl,addEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),addEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._onMouseMove(t),u._currenSliderDrag=this,this._el.classList.add("active"),cancelEvent(t))}_onMouseUp(t){cur._sliderMouseUpNowEl=this._el,removeEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove),removeEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp),this._onValueChange(),this._el.classList.remove("active"),u._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue),cancelEvent(t)}_onMouseMove(t){var e=this._getPos(),i=e[0];i=void 0!==t.touches&&t.touches.length>0?t.touches[0].pageX:t.pageX,i=Math.max(i,e[0]),i=Math.min(i,e[0]+this._width),i-=e[0],this.setValue(i/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(t,!0),cancelEvent(t)}_getPos(){return this._slidePos=window.getXY(this._slideEl)}_logf(t){if(!this.options.log)return t;var e=this.options.logfbase;return(Math.pow(e,t)-1)/(e-1)}_unlogf(t){if(!this.options.log)return t;var e,i,s=this.options.logfbase;return e=s,i=1+t*(s-1),Math.log(i)/Math.log(e)}setValue(t,e,i){if(!this._el||!this._el.classList.contains("active")||i){var s=i?this._logf(t):t;if(this._currValue!=s){this._currValue=s;var a=i?t:this._unlogf(t),o=100*a+"%";this.options.useClippedPathProgress?window.setStyle(this._amountEl,{clipPath:`inset(0 ${100*(1-a)}% 0 0)`}):window.setStyle(this._amountEl,{width:o}),window.setStyle(this._handlerEl,{left:o}),!e&&this._onValueChange()}}}setBackValue(t){this._backEl&&this._backEl.classList.toggle("slider_back_transition",t>this._backValue),this._backValue=t;var e=100*t+"%";window.setStyle(this._backEl,{width:e})}_onValueChange(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))}}function _(t,e){var i;t=Math.max(t,0);var s=Math.floor(t%60);i=s<10?"0"+s:s;var a=(t=Math.floor(t/60))%60;return i=a+":"+i,((t=Math.floor(t/60))>0||e)&&(a<10&&(i="0"+i),i=t+":"+i),i}var c,p=i(26330),g=i(79957),m=i(50519),v=!1;class f{constructor(t){var e=void 0===t?{}:t,i=e.onListened,s=e.onInit,a=e.voiceMessageHTML,o=e.onPlay,r=e.onPause,l=e.onEnd,d=e.onProgress,h=e.fcOnPause;this._reattach=!1,this._audioEl=null,this._playing=!1,this._timer=null,this._duration=0,this._detaching=!1,this._html=a,this._initCallback=s,this._playCallback=o,this._pauseCallback=r,this._endCallback=l,this._fcOnPause=h;var u={onEnd:()=>{this._endCallback&&this._audioEl&&this._endCallback(this._audioEl),this.detach()},onFail:()=>{this.detach()},onCanPlay:()=>{},onProgressUpdate:t=>{this._updateProgress(t),"function"==typeof d&&d(t,this._audioEl)}};c=!1,n.isSupported()&&(n.isSupported('audio/ogg;codecs="opus"')&&!n.isSupported('audio/ogg;codecs="codec_check"')&&(c=!0),this._impl=new n(u)),this.onPlayPause=t=>(cancelEvent(t),this._clearMediaSession(),this.toggle()),this.onDurationClick=t=>{this.durationType=!this.durationType,cancelEvent(t)},this._onListened=()=>{i&&i(this._audioEl)},this._initEvents()}_updateProgress(t){this._audioEl&&(this._duration*t>=1||this._duration<1)&&!this._audioEl._listened&&(this._audioEl._listened=!0,this._onListened()),this._durationEl&&(this.durationType?this._durationEl.innerHTML="-"+_(Math.round(this._duration*(1-t))):this._durationEl.innerHTML=_(Math.round(this._duration*t))),this._progressSlider&&this._progressSlider.setValue(t)}get type(){return this._impl.type}get durationType(){return window.AudioPlayer?!!p.default.get(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE):"1"==p.default.get("audio_time_left")}set durationType(t){window.AudioPlayer?p.default.set(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE,!!t):p.default.set("audio_time_left",t?"1":"0")}_initInterface(){var t=document.createElement("div");t.innerHTML=this._html,this._el=t.firstChild,window.getLang&&this._el.setAttribute("aria-label",getLang("mail_audio_message")),this._playBtn=this._el.querySelector(".audio-msg-track--btn");var e=this._audioEl.getAttribute("id");if(e&&this._el.setAttribute("id",`vmp_${e}`),this._audioEl.classList.contains("audio-msg-track--preview")){this._el.classList.add("audio-msg-track--preview"),this._playBtn.classList.add("audio-msg-track--btnSvg");var i=this._audioEl.querySelector(".audio-msg-track--btn");this._playBtn.innerHTML=i.innerHTML}window.getLang&&this._playBtn.setAttribute("aria-label",getLang("global_audio_play")),this._durationEl=this._el.querySelector(".audio-msg-track--duration"),this._durationEl.innerHTML=_(this._duration),this._progressSlider=new u(this._el.querySelector(".audio-msg-track--slider"),{value:0,useClippedPathProgress:!0,hintClass:"audio_player_hint",formatHint:t=>_(Math.round(t*this._duration)),onEndDragging:t=>{this._impl.seek(t)}});var s=this._audioEl.querySelector(".audio-msg-track--wave-wrapper").children[0];this._el.querySelector(".slider_slide").appendChild(s.cloneNode(!0)),this._el.querySelector(".slider_amount").appendChild(s.cloneNode(!0)),addEvent(this._playBtn,"click",this.onPlayPause),addEvent(this._durationEl,"click",this.onDurationClick),this._initCallback&&this._initCallback(this._audioEl,this._el),this._audioEl.parentNode.prepend(this._el),this._clearMediaSession()}_clearMediaSession(){m.HAS_MEDIA_SESSION&&(navigator.mediaSession.setActionHandler("play",(()=>this.play())),navigator.mediaSession.setActionHandler("pause",(()=>this.pause())),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.metadata=new MediaMetadata({title:"",artist:"",album:"",artwork:[]}))}_destroyInterface(){window.hide(this._el),this._audioEl.parentNode&&this._audioEl.parentNode.contains(this._el)&&this._audioEl.parentNode.removeChild(this._el),removeEvent(this._playBtn,"click",this.onPlayPause),this._progressSlider&&(this._progressSlider.destroy(),this._progressSlider=null),this._playBtn=null,this._durationEl=null,this._el=null}attachTo(t){if(this._audioEl!==t){null!=this._audioEl&&(this._reattach=!0),this.detach(),this._audioEl=t,this._audioEl.classList.add("audio-msg-track_player-attached"),this._duration=t.getAttribute("data-duration"),this._initInterface();var e=this._audioEl.id.split("_");e&&e.length>1&&(this._owner_id=e[1]),this._reattach=!1;var i=t.getAttribute(c?"data-ogg":"data-mp3");if(!this._impl.loaded)return new Promise(((t,e)=>{this._impl.onReady((()=>{this._impl.setUrl(i,{duration:this._duration,callback:t})}))}));this._impl.setUrl(i,{duration:this._duration})}return!0}detach(t){if(void 0===t&&(t=!1),this._audioEl&&this._el&&!this._detaching){if(t&&this.isAttached())return;this._detaching=!0,this.stop(),this._destroyInterface(),this._audioEl.classList.remove("audio-msg-track_player-attached"),this._audioEl._listened=!1,this._audioEl=null}this._detaching=!1}play(){this._audioEl&&(this._reattach||f.pauseGlobalMedia(),this._el&&this._el.classList.add("audio-msg-track_playing"),this._playBtn&&window.getLang&&this._playBtn.setAttribute("aria-label",getLang("global_audio_pause")),this._playing=!0,this._createTimer(),this._owner_id&&(0,g.statlogsValueEvent)("audio_message_play",this._owner_id),this._playCallback&&this._playCallback(this._audioEl),this._impl.play())}pause(){this._audioEl&&(!this._reattach&&this._playing&&f.resumeGlobalMedia(),this._playBtn&&window.getLang&&this._playBtn.setAttribute("aria-label",getLang("global_audio_play")),this._el&&this._el.classList.remove("audio-msg-track_playing"),this._playing=!1,this._impl.pause(),this._killTimer(),"function"==typeof this._fcOnPause&&this._fcOnPause(this._audioEl))}stop(){this.pause(),this._impl.stop()}toggle(){this._playing?(this.pause(),this._pauseCallback&&this._pauseCallback(this._audioEl)):this.play()}seek(t){this._impl.seek(t)}_createTimer(){this._duration>0&&(this._killTimer(),this._timer=setInterval((()=>{if(this._impl){var t=this._impl.getCurrentProgress();this._updateProgress(t)}}),100))}_killTimer(){this._timer&&(clearInterval(this._timer),this._timer=null)}_initEvents(){window.ap?window.ap.on(this,[l.events.PLAY_REQUESTED,l.events.PLAY],(()=>{delete window.ap.pausedByMsg,this.pause()})):window.audio&&window.audio.subscribe([l.events.PLAY_REQUESTED,l.events.PLAY],(()=>{delete window.audio.pausedByMsg,this.pause()})),window.Notifier&&(window.Notifier.addRecvClbk("audio_start","audio_msg",(()=>{this.pause()})),window.Notifier.addRecvClbk("video_start","audio_msg",(()=>{this.pause()})))}isAttached(){if(this._audioEl){for(var t=this._audioEl;t.parentNode;)t=t.parentNode;return!!t.body}return!1}static pauseGlobalMedia(){window.Notifier&&(v=!0,window.Notifier.lcSend("video_start")),window.ap&&window.ap.isPlaying()?(window.ap.pause(),window.ap.pausedByMsg=!0):window.audio&&window.audio.playing&&window.audio.playing()&&(window.audio.pause(),window.audio.pausedByMsg=!0)}static resumeGlobalMedia(){window.Notifier&&v&&(v=!1,window.Notifier.lcSend("video_hide")),window.ap&&window.ap.pausedByMsg?(window.ap.play(),delete window.ap.pausedByMsg):window.audio&&window.audio.playing&&window.audio.pausedByMsg&&((0,a.wrapAudioPlay)(window.audio).catch((()=>{})),delete window.audio.pausedByMsg)}}var w=i(49535),E=i(15544);var y={avg:class{constructor(){this.clear()}push(t){this._count++,this._accum+=t}get(){return this._accum/this._count}clear(){this._count=0,this._accum=0}},peak:class{constructor(){this.clear()}push(t){this._max=Math.max(this._max,Math.abs(t))}get(){return this._max}clear(){this._max=0}},quad:class{constructor(){this.clear()}push(t){this._count++,this._accum+=t,this._accum_q+=t*t}get(){return 1==this._count?this._accum:Math.sqrt((this._accum_q-this._accum*this._accum/this._count)/this._count)}clear(){this._count=0,this._accum=0,this._accum_q=0}}};class A{constructor(t){this._normalizeAlgorithm=!1,y[t.normalizeAlgorithm]&&(this._normalizeAlgorithm=new y[t.normalizeAlgorithm]),this._srcSampleRate=parseInt(t.srcSampleRate||0),this._dstSampleRate=parseInt(t.dstSampleRate||0),this._truncateTo=1,void 0!==t.truncateTo&&(this._truncateTo=t.truncateTo),this._dstSampleRate>0?this._sampleRate=this._srcSampleRate/this._dstSampleRate:this._sampleRate=0,y[t.algorithm]||(t.algorithm="peak"),this._algorithm=new y[t.algorithm],this._sampleCount=0,this._data=[]}push(t){if(this._sampleRate<=0)return[];for(var e,i=[],s=0;s<t.length;s++)if(this._truncateTo>0&&(t[s]=Math.min(this._truncateTo,Math.abs(t[s]))),this._sampleCount+=1,this._sampleCount>=this._sampleRate)for(;this._sampleCount>=this._sampleRate;)this._sampleCount-=this._sampleRate,this._sampleCount<=.8&&this._algorithm.push(t[s]),e=this._algorithm.get(),i.push(e),this._normalizeAlgorithm&&this._normalizeAlgorithm.push(e),this._algorithm.clear(),this._sampleCount>.2&&this._algorithm.push(t[s]);else this._algorithm.push(t[s]);if(this._normalizeAlgorithm){var a=this._normalizeAlgorithm.get();if(this._normalizeAlgorithm.clear(),a>0)for(var o=0;o<i.length;o++)i[o]=i[o]/a,this._truncateTo>0&&(i[o]=Math.min(this._truncateTo,Math.abs(i[o])))}return i}}var b=i(95724),k="audio-msg-track--transcriptToggle",M="audio-msg-track--transcript_on",S=null;function P(t){for(var e=(0,E.geByClass)("audio-msg-track--wave-wrapper",t),i=0,s=0;s<e.length;s++){try{i=parseInt(window.getComputedStyle(e[s],null).getPropertyValue("width"))}catch(t){i=parseInt(e[s].currentStyle.width)}if(i>0)break}return i}function T(t,e){var i,s,a;e=Math.round(e),t.length!=e&&(s=e,void 0===a&&(a="peak"),t=new A({srcSampleRate:(i=t).length,dstSampleRate:s,normalizeAlgorithm:a,truncateTo:0}).push(i));for(var o="",r=0,n=0;n<t.length;n++)0==(r=Math.floor(10*Number(t[n])*.95))&&(r=.5),o+="M"+(3*n+1)+","+(10-r)+"v"+2*r+"Z";return'<svg class="audio-msg-track--wave" width="'+3*t.length+'px"><path d="'+o+'"></path></svg>'}function C(){for(var t=(0,E.geByClass)("audio-msg-track"),e=0;e<t.length;e++){var i=(0,E.attr)(t[e],"data-wave");(0,E.hasClass)(t[e],"audio-msg-player")&&e>0&&(i=(0,E.attr)(t[e-1],"data-wave"));var s=P(t[e]);if(i&&s){i=i.split(",");for(var a=(0,E.geByClass)("audio-msg-track--wave",t[e]),o=T(i,s/3),r=0;r<a.length;r++){var n=(0,E.ce)("div",{innerHTML:o}).firstChild;a[r].parentNode.replaceChild(n,a[r])}}}}function L(){if(!S){var t='<div class="audio-msg-player audio-msg-track"><button class="audio-msg-track--btn"></button>'+(0,b.getTemplate)("sImAudioMsgPlayerASRToggle")+'<div class="audio-msg-track--duration"></div><div class="audio-msg-track--wave-wrapper"><div class="audio-msg-track--slider"></div></div></div>',e="audio-msg-track--with-asr-toggle",i="audio-msg-track--shortened";S=new f({onListened:function(t){window.AudioMessagePlayer.events.emit("listened",t)},voiceMessageHTML:t,onInit:function(t,s){var a,o;t.classList.contains(e)&&s.classList.add(e),t.classList.contains(i)&&s.classList.add(i),(null===(a=t.querySelector("."+k))||void 0===a?void 0:a.classList.contains(M))&&(null===(o=s.querySelector("."+k))||void 0===o||o.classList.add(M)),window.AudioMessagePlayer.events.emit("initialized",t)},onPlay:function(t){window.AudioMessagePlayer.events.emit("playing",t)},onPause:function(t){window.AudioMessagePlayer.events.emit("paused",t)},onEnd:function(t){window.AudioMessagePlayer.events.emit("finished",t)},onProgress:function(t,e){window.AudioMessagePlayer.events.emit("progress",t,e)},fcOnPause:function(t){window.AudioMessagePlayer.events.emit("fc_paused",t)}})}return S}(0,w.addEvent)(window,"orientationchange",(function(){return setTimeout(C,500)})),window.mail&&window.mail.onMessagesRepainted&&(window.onDOMReady(C),window.mail.onMessagesRepainted(C)),window.AudioMessagePlayer={loaded:!0,events:new EventEmitter,togglePlay:function(t){var e=L(),i=e.attachTo(t);!0===i?e.play():i.then((function(){e.play()}))},toggle:function(){L().toggle()},seek:function(t){L().seek(t)},detachPlayer:function(t){L().detach(t)},pauseGlobalMedia:function(){f.pauseGlobalMedia()},resumeGlobalMedia:function(){f.resumeGlobalMedia()},redrawWaves:C,getWave:T,toggleTranscript:function(t,e){(0,w.cancelEvent)(e),t.classList.toggle(M),this.events.emit("transcription_toggle",t)}};try{window.stManager.done("voice_message_player.js")}catch(t){}}},a={};function o(t){var e=a[t];if(void 0!==e)return e.exports;var i=a[t]={id:t,loaded:!1,exports:{}};return s[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=s,t=[],o.O=(e,i,s,a)=>{if(!i){var r=1/0;for(h=0;h<t.length;h++){for(var[i,s,a]=t[h],n=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(o.O).every((t=>o.O[t](i[l])))?i.splice(l--,1):(n=!1,a<r&&(r=a));if(n){t.splice(h--,1);var d=s();void 0!==d&&(e=d)}}return e}a=a||0;for(var h=t.length;h>0&&t[h-1][2]>a;h--)t[h]=t[h-1];t[h]=[i,s,a]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(t,s){if(1&s&&(t=this(t)),8&s)return t;if("object"==typeof t&&t){if(4&s&&t.__esModule)return t;if(16&s&&"function"==typeof t.then)return t}var a=Object.create(null);o.r(a);var r={};e=e||[null,i({}),i([]),i(i)];for(var n=2&s&&t;"object"==typeof n&&!~e.indexOf(n);n=i(n))Object.getOwnPropertyNames(n).forEach((e=>r[e]=()=>t[e]));return r.default=()=>t,o.d(a,r),a},o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={51745:0};o.O.j=e=>0===t[e];var e=(e,i)=>{var s,a,[r,n,l]=i,d=0;for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(l)var h=l(o);for(e&&e(i);d<r.length;d++)a=r[d],o.o(t,a)&&t[a]&&t[a][0](),t[r[d]]=0;return o.O(h)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var r=o.O(void 0,[76429,22897,68592],(()=>o(25809)));r=o.O(r)})();