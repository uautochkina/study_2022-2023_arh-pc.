/*! For license information please see 11c7a0efa74f6d488cf4ce0ffbe4d05a.b7fa677bc26d5ce62438.js.LICENSE.txt */
(self.webpackChunkvk=self.webpackChunkvk||[]).push([[79542],{10409:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon16Chevron","chevron_16","0 0 12 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 16" id="chevron_16"><path fill="currentColor" d="M7.227 8 3.864 4.636a.9.9 0 0 1 1.272-1.272l4 4a.9.9 0 0 1 0 1.272l-4 4a.9.9 0 0 1-1.272-1.272L7.227 8Z" /></symbol>',12,16)},85561:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon20DeleteOutline","delete_outline_20","0 0 20 20",'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="delete_outline_20"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.697 6.502a.75.75 0 0 0-.695.801l.5 7a.75.75 0 0 0 1.496-.106l-.5-7a.75.75 0 0 0-.801-.695zm4.606 0a.75.75 0 0 1 .695.801l-.5 7a.75.75 0 0 1-1.496-.106l.5-7a.75.75 0 0 1 .801-.695z" fill="currentColor" /><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 3a.75.75 0 0 0 0 1.5h1.066l.958 10.44c.045.489.083.898.14 1.233.06.35.15.675.331.98.279.47.691.846 1.185 1.08.32.153.652.213 1.006.24.338.027.75.027 1.24.027h3.647c.491 0 .903 0 1.24-.026.355-.028.687-.088 1.007-.24a2.75 2.75 0 0 0 1.185-1.081c.18-.305.27-.63.33-.98.058-.335.096-.744.14-1.233l.96-10.44h1.065a.75.75 0 0 0 0-1.5h-4.587a3.251 3.251 0 0 0-6.326 0H2.25zm3.516 11.774c.048.525.08.876.127 1.145.044.26.093.385.142.469.127.213.314.384.539.49.087.043.216.08.48.1.272.021.624.022 1.151.022h3.59c.527 0 .879 0 1.152-.022.263-.02.392-.057.48-.1a1.25 1.25 0 0 0 .538-.49c.05-.084.098-.209.142-.469.046-.27.08-.62.127-1.145L15.178 4.5H4.822l.944 10.274zM10 2c-.698 0-1.3.409-1.582 1h3.164A1.75 1.75 0 0 0 10 2z" fill="currentColor" /></symbol>',20,20)},94941:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon20MessagesOutline","messages_outline_20","0 0 20 20",'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="messages_outline_20"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2C4.44 2 1.5 4.518 1.5 7.754c0 1.084.336 2.12.954 3.014-.094.407-.361 1.038-.82 1.877a1.08 1.08 0 0 0 .46 1.483c.167.086.352.127.538.121 1.426-.041 2.563-.365 3.366-1.015.64.18 1.313.274 2.002.274 3.56 0 6.5-2.518 6.5-5.754C14.5 4.518 11.56 2 8 2zm0 1.5c-2.917 0-5 2.02-5 4.254 0 .788.25 1.55.726 2.216l.134.188a.75.75 0 0 1 .128.572l-.042.226c-.09.49-.324 1.087-.648 1.742.873-.107 1.438-.357 1.795-.662l.24-.206a.75.75 0 0 1 .701-.15l.308.092c.523.155 1.08.236 1.658.236 2.917 0 5-2.02 5-4.254C13 5.52 10.917 3.5 8 3.5z" fill="currentColor" /><path d="M16.157 8.575a.75.75 0 1 1 1.187-.916 5.455 5.455 0 0 1 1.156 3.345 5.42 5.42 0 0 1-.914 3.008c.088.411.346 1.049.789 1.895a1.089 1.089 0 0 1-.992 1.593c-1.363-.042-2.456-.363-3.231-1.01a6.808 6.808 0 0 1-1.902.268 6.733 6.733 0 0 1-2.57-.5.75.75 0 0 1 .572-1.388 5.22 5.22 0 0 0 1.998.388c.546 0 1.073-.08 1.568-.233l.294-.092a.75.75 0 0 1 .722.158l.23.206c.33.294.85.538 1.652.646-.311-.657-.535-1.253-.622-1.743l-.04-.225a.75.75 0 0 1 .12-.554l.129-.188a3.925 3.925 0 0 0 .697-2.23c0-.894-.306-1.733-.843-2.429z" fill="currentColor" /></symbol>',20,20)},74877:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon24DocumentOutline","document_outline_24","0 0 24 24",'<symbol viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="document_outline_24"><path d="M13.25 3.753H7.47c-1.2 0-2.169.928-2.169 2.065v11.764c0 1.137.968 2.065 2.17 2.065h9.209c1.2 0 2.169-.927 2.169-2.065V10.9h-2.274a3.325 3.325 0 0 1-3.325-3.325V3.753Zm1.775 4.197c0 .649.526 1.175 1.175 1.175h2.317l-3.492-3.97V7.95ZM3.5 5.818C3.5 3.706 5.28 2 7.47 2h5.921c.78 0 1.52.33 2.026.904L20.02 8.14c.406.461.629 1.047.629 1.653v7.79c0 2.111-1.78 3.817-3.97 3.817H7.47c-2.19 0-3.97-1.706-3.97-3.818V5.818Z" fill="currentColor" /></symbol>',24,24)},50485:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon24MoreHorizontal","more_horizontal_24","0 0 24 24",'<symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="more_horizontal_24"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z" /><path d="M18 10c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2Zm-6 4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2Zm-6 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2Z" fill="currentColor" /></g></symbol>',24,24)},54629:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(55869).makeIcon)("Icon32Play","play_32","0 0 32 32",'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="play_32"><path d="M24.948 14.001c1.154.656 1.732.984 1.925 1.412.17.374.17.8 0 1.174-.194.428-.77.756-1.925 1.412l-12.43 7.061c-1.154.656-1.732.984-2.205.935a1.471 1.471 0 0 1-1.033-.587C9 25.03 9 24.373 9 23.061V8.938c0-1.311 0-1.967.28-2.347.244-.33.62-.543 1.033-.586.473-.05 1.05.279 2.205.935L24.948 14z" fill="currentColor" /></symbol>',32,32)},55869:(e,t,n)=>{"use strict";n.d(t,{makeIcon:()=>w});var r=n(67294),o=n(87854),a=n.n(o);var i,s=r.createContext({}),c=n(62548),l=n.n(c),u=!("undefined"==typeof window||!window.document||!window.document.createElement);if(u){var d="__SVG_SPRITE_NODE__";i=new(l())({attrs:{id:d}});var f=function(){var e=document.getElementById(d);e?i.attach(e):i.mount(),document.removeEventListener("DOMContentLoaded",f)};document.querySelector("body")?f():document.addEventListener("DOMContentLoaded",f)}else i=null;var v=u?r.useLayoutEffect:r.useEffect;function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}function g(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function y(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b={display:"block"};var _=function(e){var t=e.width,n=e.height,o=e.viewBox,a=e.id,i=e.className,c=void 0===i?"":i,l=e.style,u=void 0===l?{}:l,d=e.fill,f=e.getRootRef,v=e.Component,p=void 0===v?"div":v,_=e.role,w=e["aria-label"],k=e["aria-hidden"],C=y(e,["width","height","viewBox","id","className","style","fill","getRootRef","Component","role","aria-label","aria-hidden"]),E=Math.max(t,n),A=r.useContext(s),I=function(e,t){for(var n=t.classPrefix,r=t.globalClasses,o="",a=0;a<e.length;a++)n&&(o+=" "+(n+e[a])),n&&!r||(o+=" "+e[a]);return o}(["Icon","Icon--".concat(E),"Icon--w-".concat(t),"Icon--h-".concat(n),"Icon--".concat(a)],A);return r.createElement(p,h({role:"presentation"},C,{ref:f,className:"".concat(I," ").concat(c),style:g(m({},u),{width:t,height:n})}),r.createElement("svg",{viewBox:o,width:t,height:n,style:b,role:_,"aria-label":w,"aria-hidden":k},r.createElement("use",{xlinkHref:"#".concat(a),style:{fill:"currentColor",color:d}})))};function w(e,t,n,o,s,c){var l=!1;function u(){var e;l||(e=new(a())({id:t,viewBox:n,content:o}),i&&i.add(e),l=!0)}var d=function(e){return v(u,[]),r.createElement(_,h({},e,{viewBox:n,id:t,width:isNaN(e.width)?s:+e.width,height:isNaN(e.height)?c:+e.height}))};return d.mountIcon=u,d.displayName=e,d}},54632:(e,t,n)=>{"use strict";n.d(t,{useInView:()=>u});var r=n(67294);const o=new Map,a=new WeakMap;let i,s=0;function c(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return`${t}_${"root"===t?(n=e.root,n?(a.has(n)||(s+=1,a.set(n,s.toString())),a.get(n)):"0"):e[t]}`;var n})).toString()}function l(e,t,n={},r=i){if(void 0===window.IntersectionObserver&&void 0!==r){const o=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:a,observer:s,elements:l}=function(e){let t=c(e),n=o.get(t);if(!n){const r=new Map;let a;const i=new IntersectionObserver((t=>{t.forEach((t=>{var n;const o=t.isIntersecting&&a.some((e=>t.intersectionRatio>=e));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=o),null==(n=r.get(t.target))||n.forEach((e=>{e(o,t)}))}))}),e);a=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:i,elements:r},o.set(t,n)}return n}(n);let u=l.get(e)||[];return l.has(e)||l.set(e,u),u.push(t),s.observe(e),function(){u.splice(u.indexOf(t),1),0===u.length&&(l.delete(e),s.unobserve(e)),0===l.size&&(s.disconnect(),o.delete(a))}}r.Component;function u({threshold:e,delay:t,trackVisibility:n,rootMargin:o,root:a,triggerOnce:i,skip:s,initialInView:c,fallbackInView:u,onChange:d}={}){const f=r.useRef(),v=r.useRef(),[p,h]=r.useState({inView:!!c});v.current=d;const m=r.useCallback((r=>{void 0!==f.current&&(f.current(),f.current=void 0),s||r&&(f.current=l(r,((e,t)=>{h({inView:e,entry:t}),v.current&&v.current(e,t),t.isIntersecting&&i&&f.current&&(f.current(),f.current=void 0)}),{root:a,rootMargin:o,threshold:e,trackVisibility:n,delay:t},u))}),[Array.isArray(e)?e.toString():e,a,o,i,s,n,u,t]);r.useEffect((()=>{f.current||!p.entry||i||s||h({inView:!!c})}));const g=[m,p.inView,p.entry];return g.ref=g[0],g.inView=g[1],g.entry=g[2],g}},29697:(e,t,n)=>{"use strict";n.d(t,{default:()=>v});var r=n(54337),o=n(73949),a=n(86186),i=(n(45697),n(92859)),s=n(16787),c=n(67294),l=n(96630),u=n(59391),d=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,s.default)(e,t)}))},f=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1];t.removeClasses(o,"exit"),t.addClass(o,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1]?"appear":"enter";t.addClass(o,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1]?"appear":"enter";t.removeClasses(o,a),t.addClass(o,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,o=r?""+(r&&n?n+"-":"")+e:n[e];return{baseClassName:o,activeClassName:r?o+"-active":n[e+"Active"],doneClassName:r?o+"-done":n[e+"Done"]}},t}(0,a.default)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],o=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&o&&(r+=" "+o),"active"===n&&e&&(0,u.forceReflow)(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return(0,i.default)(e,t)}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,o=n.active,a=n.done;this.appliedClasses[t]={},r&&d(e,r),o&&d(e,o),a&&d(e,a)},n.render=function(){var e=this.props,t=(e.classNames,(0,o.default)(e,["classNames"]));return c.createElement(l.default,(0,r.default)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(c.Component);f.defaultProps={classNames:""},f.propTypes={};const v=f},96630:(e,t,n)=>{"use strict";n.d(t,{default:()=>g});var r=n(73949),o=n(86186),a=(n(45697),n(67294)),i=n(73935),s=n(6035),c=n(220),l=n(59391),u="unmounted",d="exited",f="entering",v="entered",p="exiting",h=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(o=d,r.appearStatus=f):o=v:o=t.unmountOnExit||t.mountOnEnter?u:d,r.state={status:o},r.nextCallback=null,r}(0,o.default)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===u?{status:d}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==f&&n!==v&&(t=f):n!==f&&n!==v||(t=p)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===f){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:i.findDOMNode(this);n&&(0,l.forceReflow)(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===d&&this.setState({status:u})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,o=this.props.nodeRef?[r]:[i.findDOMNode(this),r],a=o[0],c=o[1],l=this.getTimeouts(),u=r?l.appear:l.enter;!e&&!n||s.default.disabled?this.safeSetState({status:v},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,c),this.safeSetState({status:f},(function(){t.props.onEntering(a,c),t.onTransitionEnd(u,(function(){t.safeSetState({status:v},(function(){t.props.onEntered(a,c)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:i.findDOMNode(this);t&&!s.default.disabled?(this.props.onExit(r),this.safeSetState({status:p},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:d},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:d},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:i.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=o[0],s=o[1];this.props.addEndListener(a,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===u)return null;var t=this.props,n=t.children,o=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,r.default)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return a.createElement(c.default.Provider,{value:null},"function"==typeof n?n(e,o):a.cloneElement(a.Children.only(n),o))},t}(a.Component);function m(){}h.contextType=c.default,h.propTypes={},h.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:m,onEntering:m,onEntered:m,onExit:m,onExiting:m,onExited:m},h.UNMOUNTED=u,h.EXITED=d,h.ENTERING=f,h.ENTERED=v,h.EXITING=p;const g=h},220:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=n(67294).createContext(null)},6035:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={disabled:!1}},59391:(e,t,n)=>{"use strict";n.d(t,{forceReflow:()=>r});var r=function(e){return e.scrollTop}},54337:(e,t,n)=>{"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{default:()=>r})},86186:(e,t,n)=>{"use strict";n.d(t,{default:()=>o});var r=n(66244);function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.default)(e,t)}},73949:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}n.d(t,{default:()=>r})},66244:(e,t,n)=>{"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{default:()=>r})},92859:(e,t,n)=>{"use strict";n.d(t,{default:()=>o});var r=n(5261);function o(e,t){e.classList?e.classList.add(t):(0,r.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}},5261:(e,t,n)=>{"use strict";function r(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}n.d(t,{default:()=>r})},16787:(e,t,n)=>{"use strict";function r(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function o(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=r(e.className,t):e.setAttribute("class",r(e.className&&e.className.baseVal||"",t))}n.d(t,{default:()=>o})},19423:(e,t,n)=>{"use strict";n.d(t,{ConvoAudiosPlaylist:()=>f,ConvoAudiosPlaylistRestored:()=>v});var r=n(80312),o=n(22559),a=n(25155),i=n(50706),s=n(9727);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){function e(t){(0,a.default)(this,e),this.convo=t}return(0,i.default)(e,[{key:"getNext",value:function(e){var t=this.getConvoAudiosList(),n=t.findIndex((function(t){return t.id===e.id})),r=t[n+1];if(r)return d(d({},r),{},{progress:0})}},{key:"getConvoAudiosList",value:function(){var e,t=[],n=c(s.iterable(this.convo));try{for(n.s();!(e=n.n()).done;){var o,a=e.value.message;if("Service"!==a.kind&&"Expired"!==a.kind){var i=[];if(Array.isArray(a.attaches.audios)){var l=(0,r.default)(a.attaches.audios);i.push.apply(i,(0,r.default)(l.reverse()))}var u=null===(o=a.attaches.wall)||void 0===o?void 0:o.attaches.audios;if(Array.isArray(u)){var f=(0,r.default)(u);i.push.apply(i,(0,r.default)(f.reverse()))}i.forEach((function(e){e.url&&t.push(d(d({},e),{},{id:"".concat(e.ownerId,"_").concat(e.id)}))}))}}}catch(e){n.e(e)}finally{n.f()}return t.reverse()}},{key:"getPlaylistMeta",value:function(){return{type:"temp",convoPeerId:this.convo.peerId}}}]),e}(),v=function(){function e(t){(0,a.default)(this,e),this.list=t.list,this.meta=t.meta}return(0,i.default)(e,[{key:"getNext",value:function(e){var t=this.list.findIndex((function(t){return t.id===e.id})),n=this.list[t+1];if(n)return d(d({},n),{},{progress:0})}},{key:"getConvoAudiosList",value:function(){return this.list}},{key:"getPlaylistMeta",value:function(){return this.meta}}]),e}()},84970:(e,t,n)=>{"use strict";n.d(t,{usePrevious:()=>h,useDidUpdate:()=>m,useDebounced:()=>g,useOnline:()=>y,OnlinesProvider:()=>_,useDispatch:()=>w,DispatchProvider:()=>C,useHelpHints:()=>E,HelpHintsProvider:()=>I,useTypings:()=>O,TypingsProvider:()=>x,usePixelDensity:()=>M,matchAddEventListener:()=>j,useNow:()=>N,usePeers:()=>L,PeersProvider:()=>R,useConvos:()=>T,ConvosProvider:()=>F,useFeatureFlags:()=>U,FeatureFlagsProvider:()=>H,useOwner:()=>K,OwnerProvider:()=>z,useViewer:()=>q,ViewerProvider:()=>$,useAppSource:()=>J,AppSourceProvider:()=>Y,useBrowserEnv:()=>X,BrowserEnvProvider:()=>ee,useViewport:()=>te,useRead:()=>re,useCombinedRefs:()=>oe,InsertIntoCacheProvider:()=>ie,useInsertIntoCache:()=>se,ConvosSearchIndexProvider:()=>le,useConvosSearchIndex:()=>ue});var r=n(22559),o=n(56568),a=n(67294),i=n(54632),s=n(14432),c=n(33600),l=n(21705),u=n(37021);function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e){var t=(0,a.useRef)();return(0,a.useEffect)((function(){t.current=e}),[e]),t.current}function m(e,t){var n=(0,a.useRef)(!1);(0,a.useEffect)((function(){if(n.current)return e()}),t),(0,a.useEffect)((function(){n.current=!0}),[])}function g(e,t){var n=(0,a.useState)({debounced:e,debouncedUpdatesCount:0}),r=(0,o.default)(n,2),i=r[0],s=r[1];return(0,a.useLayoutEffect)((function(){if(0!==t){var n=setTimeout((function(){s((function(t){var n=t.debouncedUpdatesCount;return{debounced:e,debouncedUpdatesCount:n+1}}))}),t);return function(){clearTimeout(n)}}s((function(t){return p(p({},t),{},{debounced:e})}))}),[e,t]),i}function y(e){var t=(0,a.useContext)(b);return!!s.isUserPeerId(e)&&t.has(e)}var b=a.createContext(new Set),_=b.Provider;function w(){var e=(0,a.useContext)(k);if(!e)throw new Error("DispatchProvider не добавлен в дерево Реакта!");return e}var k=a.createContext(null),C=k.Provider;function E(){var e=(0,a.useContext)(A);if(void 0===e)throw new Error("HelpHintsProvider не добавлен в дерево Реакта!");return e}var A=a.createContext(null),I=A.Provider;function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=(0,a.useContext)(P),o=L(),i=X(),c=i.lang,l=r.get(e);if(l){var f,v=[],p=new Set,h=d(u.TypingVariants);try{for(h.s();!(f=h.n()).done;){var m=f.value,g=l[m];g&&(v.push(m),g.peerIds.forEach((function(e){return p.add(e)})))}}catch(e){h.e(e)}finally{h.f()}var y=v.length>1?"text":v[0]||"text";if(0===n)return{text:c.use("me_typing_".concat(y)),type:y};var b,_,w=[],k=d(p);try{for(k.s();!(b=k.n()).done;){var C=b.value,E=o.get(C);if(E&&(w.push(E),w.length===n))break}}catch(e){k.e(e)}finally{k.f()}var A=", ",I=p.size-w.length;switch(!0){case 0===w.length&&I>0:_=c.use("me_typing_people",{num:I});break;case I>0:_=w.map(s.shortName).join(A),_=c.use("me_typing_names_lots",{num:I,values:{names:_}});break;case w.length>1:var O=w.length>n-1?w.slice(0,n-1).map(s.shortName).join(A):w[0]?s.shortName(w[0]):"",x=w[w.length-1],S=x?s.shortName(x):"";_=c.use("me_typing_names_couple",{values:{before:O,after:S}});break;case 1===w.length:_=w[0]?s.shortName(w[0]):"";break;default:_=""}var M="compact"===t?_:c.use("me_typing_".concat(y,"_named"),{num:w.length,values:{names:_}});return{text:M,type:y}}}var P=a.createContext(new Map),x=P.Provider,S=function(){return window.devicePixelRatio>1.3};function M(){var e=(0,a.useState)(S),t=(0,o.default)(e,2),n=t[0],r=t[1];return(0,a.useEffect)((function(){return j(window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),(function(){r(S)}))}),[]),n}function j(e,t){try{return e.addEventListener("change",t),function(){e.removeEventListener("change",t)}}catch(n){return e.addListener(t),function(){e.removeListener(t)}}}function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,t=(0,a.useState)(Date.now),n=(0,o.default)(t,2),r=n[0],i=n[1];return(0,a.useLayoutEffect)((function(){var t=setInterval((function(){i(Date.now())}),e);return function(){return clearInterval(t)}}),[e]),r}function L(){return(0,a.useContext)(D)}var D=a.createContext(new Map),R=D.Provider;function T(){return(0,a.useContext)(B)}var B=a.createContext(new Map),F=B.Provider;function U(){var e=(0,a.useContext)(V);if(!e)throw new Error("FeatureFlagsProvider не добавлен в дерево Реакта!");return e}var V=a.createContext(null),H=V.Provider;function K(){var e=(0,a.useContext)(G);if(!e)throw new Error("OwnerProvider не добавлен в дерево Реакта!");return e}var G=a.createContext(null),z=G.Provider;function q(){var e=(0,a.useContext)(W);if(!e)throw new Error("ViewerProvider не добавлен в дерево Реакта!");return e}var W=a.createContext(null),$=W.Provider;function J(){var e=(0,a.useContext)(Z);if(!e)throw new Error("AppSourceProvider не добавлен");return e}var Z=a.createContext(null),Y=Z.Provider;function X(){var e=(0,a.useContext)(Q);if(!e)throw new Error("BrowserEnvProvider не добавлен в дерево Реакта!");return e}var Q=a.createContext(null),ee=Q.Provider;function te(e){var t=e.debounced,n=void 0!==t&&t,r=(0,a.useState)(ne),i=(0,o.default)(r,2),s=i[0],c=i[1],u=(0,a.useRef)((0,l.debounce)(c,300,!1));return(0,a.useLayoutEffect)((function(){var e=u.current,t=function(){n?e(ne()):c(ne())};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),n&&e.cancel()}}),[n]),s}function ne(){return"undefined"==typeof window?[0,0]:[document.documentElement.clientWidth,document.documentElement.clientHeight]}function re(e){var t=e.isUnread,n=e.isOut,r=e.onRead,o=X().idle,s=(0,i.useInView)({threshold:.01,triggerOnce:!0,delay:500}),c=s.ref,l=s.inView;return(0,a.useEffect)((function(){if(l&&t&&!n)return o.isIdle()?o.subscribe((function(e){e||setTimeout((function(){return r()}),1e3)})):void r()}),[l,t,r,o,n]),c}function oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=(0,a.useRef)(null);return a.useEffect((function(){t.forEach((function(e){e&&("function"==typeof e?e(r.current):e.current=r.current)}))}),[t]),r}var ae=a.createContext(null),ie=ae.Provider;function se(){var e=(0,a.useContext)(ae);if(!e)throw new Error("InsertIntoCacheProvider не добавлен в дерево Реакта!");return e}var ce=a.createContext(c.create()),le=ce.Provider;function ue(){return(0,a.useContext)(ce)}},77673:(e,t,n)=>{"use strict";n.d(t,{useComposerDraft:()=>a,ComposerDraftsContext:()=>i});var r=n(67294),o=n(89018);function a(e){var t,n=(0,r.useContext)(i);if(!n)throw new Error("SaveMessageDraftProvider не добавлен в дерево Реакта!");return null!==(t=n[e])&&void 0!==t?t:o.DEFAULT_DRAFT}var i=r.createContext({})},48521:(e,t,n)=>{"use strict";n.d(t,{useModuleKeyBoardHandlers:()=>l,useGlobalKeyBoardHandlers:()=>u,KeyBoardHandlersProvider:()=>d});var r=n(80312),o=n(56568),a=n(8994),i=n(67294),s=n(12869),c=(0,i.createContext)(null),l=function(e){var t=e.moduleName,n=e.activateOnFirstRender,r=void 0===n||n,o=e.activateOnFocusInRef,s=e.blockGlobalHandlersWhileActive,l=void 0!==s&&s,u=(0,i.useContext)(c);if(!u)throw new Error("KeyBoardHandlersContext не добавлен в дерево Реакта!");var d=(0,i.useRef)("".concat(t,"_").concat((0,a.nanoid)(7))),f=u.activeModule,v=u.activateModule,p=u.removeModuleFromActiveStack,h=u.subscribeModuleKeyDown,m=u.isGlobalHandlersBlocked,g=u.blockGlobalHandlers,y=u.unblockGlobalHandlers,b=(0,i.useCallback)((function(){v(d.current),l&&g()}),[v,g,l,d]),_=(0,i.useCallback)((function(){p(d.current),f===d.current&&l&&y()}),[f,p,y,l]),w=(0,i.useCallback)((function(e){return h(d.current,e)}),[h]);return(0,i.useLayoutEffect)((function(){return r&&b(),function(){_()}}),[]),(0,i.useLayoutEffect)((function(){var e,t=null==o?void 0:o.current;if(t)return t.tabIndex=null!==(e=t.tabIndex)&&void 0!==e?e:-1,t.addEventListener("focusin",b,!0),t.addEventListener("focusout",_,!0),function(){t.removeEventListener("focusin",b,!0),t.removeEventListener("focusout",_,!0)}}),[o,b,_]),(0,i.useEffect)((function(){if(d.current===f)return!m&&l&&g(),m&&!l&&y(),function(){l&&y()}}),[d,f,m,l,g,y]),{activateModule:b,removeModuleFromActiveStack:_,subscribeKeyDown:w,blockGlobalHandlers:g,unblockGlobalHandlers:y}},u=function(){var e=(0,i.useContext)(c);if(!e)throw new Error("KeyBoardHandlersContext не добавлен в дерево Реакта!");return{blockGlobalHandlers:e.blockGlobalHandlers,unblockGlobalHandlers:e.unblockGlobalHandlers,subscribeGlobalKeyDown:e.subscribeGlobalKeyDown}},d=function(e){var t=e.children,n=(0,i.useState)([]),l=(0,o.default)(n,2),u=l[0],d=l[1],p=(0,i.useState)(),h=(0,o.default)(p,2),m=h[0],g=h[1],y=(0,i.useRef)((0,a.nanoid)(7)),b=(0,i.useRef)(new Map);(0,i.useEffect)((function(){g((function(){return u[u.length-1]})),f(y.current)}),[u]);var _=(0,i.useCallback)((function(e,t){if(b.current.has(e))throw new Error("Module ".concat(e," is already subscribed. Unsubscribe it first."));return b.current.set(e,t),function(){b.current.delete(e)}}),[]),w=(0,i.useCallback)((function(e,t){var n=(0,r.default)(e),o=n.indexOf(t);return-1!==o&&n.splice(o,1),n}),[]),k=(0,i.useCallback)((function(e){d((function(t){return w(t,e)}))}),[w]),C=(0,i.useCallback)((function(e){d((function(t){var n=w(t,e);return[].concat((0,r.default)(n),[e])}))}),[w]),E=(0,i.useRef)(new Map),A=(0,i.useRef)(!1),I=(0,i.useCallback)((function(e,t){if(E.current.has(e))throw new Error("Global keyCombo ".concat(e," is already subscribed. Unsubscribe it first"));return E.current.set(e,t),function(){E.current.delete(e)}}),[]),O=(0,i.useCallback)((function(){A.current=!0}),[]),P=(0,i.useCallback)((function(){A.current=!1}),[]),x=(0,i.useCallback)((function(e,t){if(void 0!==m&&v(y.current)){var n=b.current.get(m);n&&n(e,t)}}),[m]),S=(0,i.useCallback)((function(e,t){if(A.current)t();else{var n=E.current.get(e);n&&(!1!==n.autoPreventDefault?(t(),n.handler()):n.handler(t))}}),[]),M=(0,i.useCallback)((function(e){if(e instanceof KeyboardEvent){var t=(0,s.getKeyCombo)(e),n=e.preventDefault.bind(e);(0,s.isGlobalKeyCombo)(t)?S(t,n):(0,s.isModuleKeyCombo)(t)&&x(t,n)}}),[x,S]);(0,i.useEffect)((function(){return document.addEventListener("keydown",M),function(){document.removeEventListener("keydown",M)}}),[M]);var j=(0,i.useMemo)((function(){return{activeModule:m,subscribeGlobalKeyDown:I,subscribeModuleKeyDown:_,activateModule:C,removeModuleFromActiveStack:k,isGlobalHandlersBlocked:A.current,blockGlobalHandlers:O,unblockGlobalHandlers:P}}),[m,I,_,C,k,O,P]);return i.createElement(c.Provider,{value:j},t)},f=function(e){window.sessionStorage.setItem("active_key_board_handling_context",e)},v=function(e){var t=window.sessionStorage.getItem("active_key_board_handling_context");return null===t||e===t}},66600:(e,t,n)=>{"use strict";n.d(t,{ActionsMenu:()=>v,ActionsMenuAction:()=>p,ActionsMenuDropdownAction:()=>h,ActionsMenuSeparator:()=>m});var r=n(56568),o=n(14957),a=n(16790),i=n(67294),s=n(20700),c=n.n(s),l=n(10409),u=n(84839),d=["leftIcon","rightIcon","title","type","className","children","onClick"],f=["children","icon","openType"],v=function(e){var t=e.className,n=e.children;return i.createElement("div",{className:c()("ActionsMenu",t)},n)},p=function(e){var t=e.leftIcon,n=e.rightIcon,r=e.title,s=e.type,l=void 0===s?"primary":s,u=e.className,f=(e.children,e.onClick),v=(0,a.default)(e,d);return i.createElement("button",(0,o.default)({},v,{className:c()("ActionsMenuAction",l&&"ActionsMenuAction--".concat(l),u),onClick:f}),t&&i.createElement("i",{className:"ActionsMenuAction__icon"},t),i.createElement("span",{className:"ActionsMenuAction__title"},r),n&&i.createElement("i",{className:"ActionsMenuAction__icon"},n))},h=function(e){var t=e.children,n=e.icon,s=e.openType,c=(0,a.default)(e,f),d=(0,i.useState)(!1),h=(0,r.default)(d,2),m=h[0],g=h[1];return i.createElement(u.Dropdown,{content:i.createElement(v,{className:"ActionsMenu--dropdown"},t),openType:s,position:"right",align:"left",onOpen:function(){return g(!0)},onClose:function(){return g(!1)},hideOnClick:!0},i.createElement(p,(0,o.default)({},c,{className:m&&"ActionsMenuAction--active",leftIcon:n,rightIcon:i.createElement(l.default,null)})))},m=function(e){var t=e.className;return i.createElement("div",{role:"separator",className:c()("ActionsMenuAction__separator",t)})}},81758:(e,t,n)=>{"use strict";n.d(t,{AttachAudio:()=>v});var r=n(22559),o=n(56568),a=n(67294),i=n(20700),s=n.n(i),c=n(21705),l=n(84970),u=n(88751);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=a.memo((function(e){var t=e.audio,n=(0,l.useBrowserEnv)().player,r=(0,a.useContext)(u.ConvoAudiosPlaylistContext),i=(0,a.useState)("stopped"),d=(0,o.default)(i,2),v=d[0],h=d[1],m=(0,a.useState)(0),g=(0,o.default)(m,2),y=g[0],b=g[1],_=(0,a.useRef)("".concat(t.ownerId,"_").concat(t.id)),w=(0,a.useCallback)((function(e){var t=e.currentAudioTrack,n=e.status;if(t&&t.id===_.current){var r=t.progress;h(n),b(r)}}),[]);(0,a.useEffect)((function(){return n.subscribe("stateupdated",w),function(){n.unsubscribe("stateupdated",w)}}),[t,w,n]),(0,a.useEffect)((function(){w(n.getState())}),[]);var k=(0,a.useCallback)((function(e){if(t.url){if("playing"===v)n.pause();else{var o=r();n.play(f(f({},t),{},{progress:y,id:"".concat(t.ownerId,"_").concat(t.id)}),o)}e.preventDefault()}}),[t,v,n,r,y]);return a.createElement("div",{className:s()("AttachAudio",{"AttachAudio--active":"playing"===v||"paused"===v,"AttachAudio--playing":"playing"===v})},a.createElement("button",{className:"AttachAudio__play",onClick:k},a.createElement("div",{className:s()("AttachAudio__playIcon","playing"===v&&"AttachAudio__playIcon--playing")},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:8,height:10,fill:"currentColor"},"playing"!==v&&a.createElement("path",{d:"M1.54 9.4A1 1 0 010 8.58V1.43A1 1 0 011.54.59l5.9 3.82a.7.7 0 010 1.18L1.54 9.4z"}),"playing"===v&&a.createElement("path",{d:"M.6 0a.6.6 0 00-.6.6v8.8c0 .33.27.6.6.6h1.8a.6.6 0 00.6-.6V.6a.6.6 0 00-.6-.6H.6zm5 0a.6.6 0 00-.6.6v8.8c0 .33.27.6.6.6h1.8a.6.6 0 00.6-.6V.6a.6.6 0 00-.6-.6H5.6z"})))),a.createElement("div",{className:"AttachAudio__title"},t.title),a.createElement("div",{className:"AttachAudio__artist"},t.artist),a.createElement("div",{className:"AttachAudio__duration","data-filler":p(t.duration)},a.createElement("div",{className:"AttachAudio__durationIn"},"playing"===v||"paused"===v?function(e,t){var n=Math.floor(t*(1-e));return"-"+(0,c.formatDuration)(n)}(y,t.duration):(0,c.formatDuration)(t.duration))))}));function p(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t?"-":"";return n+Math.floor(e/60).toString().split("").fill("0").join("")+":00"}},70722:(e,t,n)=>{"use strict";n.d(t,{AttachDoc:()=>m});var r=n(67294),o=n(56568),a=n(51225),i=n(40637),s=n(59590),c=n(54629),l=n(84970),u=n(87075),d=function(e){var t=e.doc,n=e.meta,d=e.isInBubble,f=void 0!==d&&d,v=e.forwardLevel,p=void 0===v?0:v,h=(0,r.useState)(!1),m=(0,o.default)(h,2),g=m[0],y=m[1],b=(0,l.usePixelDensity)(),_="gif"===t.ext,w=(0,u.getExpectedAttachWidth)(b,f,p,232),k=(0,o.default)(w,2),C=k[0],E=k[1],A=a.preview(t,E);if(!A)return null;var I=Math.min(A.width,C),O=Math.ceil(A.height/A.width*I);return r.createElement(i.Link,{href:t.url,className:"AttachDocPreview",style:{width:I,height:O},download:!_,onClick:_?function(e){y((function(e){return!e})),e.preventDefault()}:void 0,target:_?void 0:"_blank"},_&&!g&&r.createElement("div",{className:"AttachDocPreview__play"},r.createElement(c.default,null)),r.createElement("img",{src:g?t.url:A.url,alt:t.title}),r.createElement(s.ComposerAttachPreviewMeta,{rounded:!0,top:!0,left:!0},n))},f=n(74877),v=n(21705),p=n(20700),h=n.n(p),m=function(e){var t=e.doc,n=e.withoutPreview,o=void 0!==n&&n,a=e.isInBubble,s=void 0!==a&&a,c=e.forwardLevel,l=void 0===c?0:c,u=e.isOut,p=void 0!==u&&u,m=t.ext.toUpperCase()+" · "+(0,v.formatFileSize)(t.size);return!o&&t.image?r.createElement(d,{doc:t,meta:m,isInBubble:s,forwardLevel:l}):r.createElement(i.Link,{href:t.url,target:"_blank",className:"AttachDoc",download:!0},r.createElement("figure",{className:h()("AttachDoc__icon",{"AttachDoc__icon--isOut":p})},r.createElement(f.default,null)),r.createElement("div",{className:"AttachDoc__title"},t.title),r.createElement("div",{className:"AttachDoc__meta"},m))}},15134:(e,t,n)=>{"use strict";n.d(t,{AttachVideos:()=>v,getDuration:()=>p});var r=n(56568),o=n(67294),a=n(51225),i=n(84970),s=n(20700),c=n.n(s),l=n(54629),u=n(21705),d=n(40637),f=n(87075),v=function(e){var t=e.videos,n=e.isInBubble,s=e.forwardLevel,u=void 0===s?0:s,v=e.additionalLinkPayload,h=(0,i.usePixelDensity)(),m=(0,i.useBrowserEnv)().navigate,g=(0,f.getExpectedAttachWidth)(h,n,u,216),y=(0,r.default)(g,2)[1];return o.createElement("div",{className:c()("AttachVideos",{"AttachVideos--inBubble":n})},t.map((function(e){var t,n,r,i,s,u,f=e.height,h=void 0===f?9:f,g=e.width,b=void 0===g?16:g,_=e.duration,w=e.platform,k=e.files,C=a.preview(e,y);if(!C)return null;var E=1===(null===(t=e.restriction)||void 0===t?void 0:t.blur),A=0===(null===(n=e.restriction)||void 0===n?void 0:n.can_play),I=p(_,!(null==k||!k.external))||w;return o.createElement("div",{className:"AttachVideos__item",key:e.id},o.createElement(d.Link,{className:"AttachVideos__video",style:{paddingTop:"".concat(h/b*100,"%"),height:0},href:m.getAttachLink(e),payload:{kind:"attachMedia",attach:e,source:v}},o.createElement("div",{className:c()("AttachVideos__preview",{AttachVideos__previewBackdrop:E||A}),style:{background:0===C.url.length?"black":"url('".concat(C.url,"') center / cover no-repeat")}}),!E&&o.createElement(o.Fragment,null,o.createElement("div",{className:"AttachVideos__videoPlay"},o.createElement(l.default,null)),I&&o.createElement("div",{className:"AttachVideos__videoInfo"},I)),(E||A)&&o.createElement("div",{className:"AttachVideos__videoRestrictionWrap"},o.createElement("div",{className:"AttachVideos__videoIconRestriction",style:{backgroundImage:"url('".concat(null===(r=e.restriction)||void 0===r||null===(i=r.card_icon)||void 0===i||null===(s=i.slice(-1).pop())||void 0===s?void 0:s.url,"')"),filter:"invert(100%)"}}),void 0!==(null===(u=e.restriction)||void 0===u?void 0:u.title)&&o.createElement("div",null,e.restriction.title))))})))};function p(e,t){return void 0===e?"":!t||t&&e?(0,u.formatDuration)(e):""}},59590:(e,t,n)=>{"use strict";n.d(t,{ComposerAttachPreviewMeta:()=>l});var r=n(22559),o=n(67294),a=n(20700),i=n.n(a);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t=e.children,n=e.rounded,r=e.offsetLength,a=void 0===r?5:r,s=e.top,l=e.right,u=e.bottom,d=e.left,f=["ComposerAttachPreviewMeta",{"ComposerAttachPreviewMeta--rounded":n}],v=a+"px",p=c(c(c(c({},s&&{top:v}),l&&{right:v}),u&&{bottom:v}),d&&{left:v});return o.createElement("div",{className:i()(f),style:p},t)}},12427:(e,t,n)=>{"use strict";n.d(t,{ConvoAttachments:()=>J});var r=n(67846),o=n(56568),a=n(43883),i=n.n(a),s=n(67294),c=n(58346),l=n(81758),u=n(70722),d=n(9727),f=n(80662),v=n(71851),p=n(22559),h=n(84970),m=n(3460),g=n(21705),y=n(37021);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,p.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n,r,o){return k.apply(this,arguments)}function k(){return(k=(0,r.default)(i().mark((function e(t,n,r,o,a){var s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.fetch("messages.getHistoryAttachments",{peer_id:n,media_type:C(o),count:30,start_from:a,group_id:(0,y.getOwnerGroupId)(r)},{retries:5});case 3:if((s=e.sent).items&&0!==s.items.length){e.next=6;break}return e.abrupt("return",(0,p.default)({},o,{items:[],isAllLoaded:!0,cursorNextLoad:null}));case 6:return c=(0,m.fromApiConvoAttach)(s.items)[o]||[],e.abrupt("return",(0,p.default)({},o,{items:c,isAllLoaded:0===c.length||c.length<30,cursorNextLoad:s.next_from}));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var C=function(e){return{audios:"audio",videos:"video",docs:"doc",links:"link",photos:"photo"}[e]};function E(e,t,n){e[n]||function(e,t){switch(t){case"audios":case"videos":case"docs":case"links":case"photos":e[t]={items:[],cursorNextLoad:null,isAllLoaded:!1};break;default:(0,g.exhaustivenessCheck)(t)}}(e,n);var r=e[n];r&&(r.isLoading=t)}function A(e,t){var n,r,o,a,i;t.audios&&(e.audios={items:((null===(n=e.audios)||void 0===n?void 0:n.items)||[]).concat(t.audios.items),cursorNextLoad:t.audios.cursorNextLoad||null,isAllLoaded:t.audios.isAllLoaded});t.docs&&(e.docs={items:((null===(r=e.docs)||void 0===r?void 0:r.items)||[]).concat(t.docs.items),cursorNextLoad:t.docs.cursorNextLoad||null,isAllLoaded:t.docs.isAllLoaded});t.links&&(e.links={items:((null===(o=e.links)||void 0===o?void 0:o.items)||[]).concat(t.links.items),cursorNextLoad:t.links.cursorNextLoad||null,isAllLoaded:t.links.isAllLoaded});t.photos&&(e.photos={items:((null===(a=e.photos)||void 0===a?void 0:a.items)||[]).concat(t.photos.items),cursorNextLoad:t.photos.cursorNextLoad||null,isAllLoaded:t.photos.isAllLoaded});t.videos&&(e.videos={items:((null===(i=e.videos)||void 0===i?void 0:i.items)||[]).concat(t.videos.items),cursorNextLoad:t.videos.cursorNextLoad||null,isAllLoaded:t.videos.isAllLoaded})}var I=n(14957),O=n(80312),P=n(51225),x=n(40637),S=n(84839),M=n(94941),j=n(85561),N=n(50485),L=n(66600),D=function(e){var t=e.photos,n=e.tailWatchBind,r=e.goToMessage,a=e.isCasper,i=(0,h.useBrowserEnv)().api,c=(0,s.useState)(0),l=(0,o.default)(c,2),u=l[0],d=l[1],f=(0,s.useRef)(null),v=(0,s.useState)([]),p=(0,o.default)(v,2),m=p[0],y=p[1];(0,s.useLayoutEffect)((function(){if(window.IntersectionObserver&&0===u&&f.current){var e=new ResizeObserver((function(t){var n;t[0]&&d(t[0].contentRect.width),0===(null===(n=t[0])||void 0===n?void 0:n.contentRect.width)&&e.disconnect()}));return e.observe(f.current),function(){e.disconnect()}}}),[]);var b=(0,s.useCallback)((function(e,t){switch(e){case"set_as_avatar":case"copy_link":case"download":case"tag_item":case"tag_service":break;case"delete":i.fetch("photos.delete",{photo_id:t.attach.id,owner_id:t.attach.ownerId}).then((function(){y([].concat((0,O.default)(m),[t.attach.id]))}));break;case"restore":i.fetch("photos.restore",{photo_id:t.attach.id,owner_id:t.attach.ownerId}).then((function(){y(m.filter((function(e){return e!==t.attach.id})))}));break;case"go_to_message":r(t.messageId);break;default:(0,g.exhaustivenessCheck)(e)}}),[r,i,m]);return s.createElement("ul",{className:"ConvoAttachesPhotos"},t.map((function(e,t,r){var o=0===t,i=t===r.length-1,c=0!==u?function(e,t){var n=P.preview(e,t,t,!1),r=P.preview(e,2*t,2*t,!1);if(!n&&!r)return null;if(!n||!r)return{src:n?n.url:r?r.url:""};return{srcSet:"".concat(n.url,", ").concat(r.url," 2x"),src:r.url}}(e.attach,u):void 0;return s.createElement(R,{key:"".concat(e.cmid,"-").concat(e.attach.id),isDeleted:m.includes(e.attach.id),isCasper:a,photo:e,photoSource:c||void 0,tailWatchBind:i?n:void 0,measuredElRef:o?f:void 0,onActionClick:b})})))},R=function(e){var t=e.photo,n=(e.isCasper,e.measuredElRef),r=e.tailWatchBind,o=e.photoSource,a=e.isDeleted,i=e.onActionClick,c=(0,h.useBrowserEnv)(),l=c.lang,u=c.navigate,d=(0,s.useMemo)((function(){return s.createElement(s.Fragment,null,s.createElement(L.ActionsMenuAction,{key:"action_go_to_message",onClick:function(){return i("go_to_message",t)},title:l.use("me_attach_action_go_to_message"),leftIcon:s.createElement(M.default,null),type:"primary"}),s.createElement(L.ActionsMenuAction,{key:"action_delete",onClick:function(){return i("delete",t)},title:l.use("me_attach_action_delete_photo"),leftIcon:s.createElement(j.default,null),type:"danger"}))}),[l,t,i]),f={kind:"message",peerId:t.peerId,cmid:t.cmid};return s.createElement("li",{className:"ConvoAttachesPhotos__item",ref:n},r&&s.createElement("div",{className:"ConvoAttachesPhotos__tail",ref:r}),o&&!a&&s.createElement(s.Fragment,null,s.createElement(x.Link,{href:u.getAttachLink(t.attach,f),payload:{kind:"attachMedia",attach:t.attach,source:f},target:"_blank",rel:"noreferrer",key:t.attach.id,className:"ConvoAttachesPhotos__link"},s.createElement("img",(0,I.default)({},o,{alt:"",className:"ConvoAttachPhoto__img"}))),s.createElement(S.Dropdown,{classNames:{wrapper:"ConvoAttachPhoto__dropdown"},content:s.createElement(L.ActionsMenu,{className:"ConvoActionsMenu"},d),align:"center",position:"left",hideOnClick:!0},s.createElement("button",{className:"ConvoAttachPhoto__action","aria-label":l.use("me_actions_more")},s.createElement(N.default,null)))),o&&a&&s.createElement("div",{className:"ConvoAttachesPhotos__restore"},s.createElement("div",{className:"ConvoAttachesPhoto__restore-button",onClick:function(){return i("restore",t)}},l.use("me_attach_action_restore"))))};var T=n(20700),B=n.n(T),F=n(15134),U=function(e){var t=e.videos,n=e.tailWatchBind,r=e.goToMessage,a=(0,s.useState)(0),i=(0,o.default)(a,2),c=i[0],l=i[1],u=(0,h.useBrowserEnv)().api,d=(0,s.useRef)(null),f=(0,s.useState)([]),v=(0,o.default)(f,2),p=v[0],m=v[1],y=(0,h.useViewer)().viewer;(0,s.useLayoutEffect)((function(){if(window.IntersectionObserver&&0===c&&d.current){var e=new ResizeObserver((function(t){var n;t[0]&&l(t[0].contentRect.width),0===(null===(n=t[0])||void 0===n?void 0:n.contentRect.width)&&e.disconnect()}));return e.observe(d.current),function(){e.disconnect()}}}),[]);var b=(0,s.useCallback)((function(e,t){switch(e){case"go_to_message":r(t.messageId);break;case"delete_from_own":u.fetch("video.delete",{video_id:t.attach.id,owner_id:t.attach.ownerId,target_id:y.id}).then((function(){m([].concat((0,O.default)(p),[t.attach.id]))}));break;case"restore":u.fetch("video.restore",{video_id:t.attach.id,owner_id:t.attach.ownerId}).then((function(){m(p.filter((function(e){return e!==t.attach.id})))}));break;case"copy_link":case"download":case"report":case"share":case"add":case"add_to_playlist":break;default:(0,g.exhaustivenessCheck)(e)}}),[r,u,p,y.id]);return s.createElement("ul",{className:"ConvoAttachesVideos"},t.map((function(e,t,r){var o,a,i=0===t,l=t===r.length-1,u=0!==c?function(e,t){var n=P.preview(e,t),r=P.preview(e,2*t);if(!n&&!r)return null;if(!n||!r)return{src:n?n.url:r?r.url:""};return{srcSet:"".concat(n.url,", ").concat(r.url," 2x"),src:r.url}}(e.attach,c):void 0,f=1===(null===(o=e.attach.restriction)||void 0===o?void 0:o.blur),v=0===(null===(a=e.attach.restriction)||void 0===a?void 0:a.can_play);return s.createElement(V,{key:"".concat(e.cmid,"-").concat(e.attach.id),measuredElRef:i?d:void 0,tailWatchBind:l?n:void 0,isDeleted:p.includes(e.attach.id),onActionClick:b,video:e,isBlur:f,videoSource:u||void 0,canNotPlay:v})})))},V=function(e){var t,n,r,o,a=e.video,i=e.tailWatchBind,c=e.videoSource,l=e.isDeleted,u=e.measuredElRef,d=e.isBlur,f=e.canNotPlay,v=e.onActionClick,p="ME"!==(0,h.useAppSource)(),m=(0,h.useBrowserEnv)(),g=m.lang,y=m.navigate,b=a.attach,_=b.duration,w=b.title,k=b.views,C=b.platform,E=b.files,A=(0,F.getDuration)(_,!(null==E||!E.external))||C,O=(0,s.useMemo)((function(){return s.createElement(s.Fragment,null,s.createElement(L.ActionsMenuAction,{key:"action_go_to_message",onClick:function(){return v("go_to_message",a)},title:g.use("me_attach_action_go_to_message"),leftIcon:s.createElement(M.default,null),type:"primary"}))}),[g,a,v]);return s.createElement("li",{className:"ConvoAttachesVideos__item",ref:u},i&&s.createElement("div",{className:"ConvoAttachesVideos__tail",ref:i}),s.createElement("div",{className:"ConvoAttachesVideos__preview"},c&&!l&&s.createElement(s.Fragment,null,s.createElement(x.Link,{href:y.getAttachLink(a.attach),payload:{kind:"attachMedia",attach:a.attach},target:"_blank",rel:"noreferrer",className:B()({ConvoAttachesVideo__link:p||d||f,ConvoAttachesVideo__play:!p})},s.createElement("img",(0,I.default)({},c,{alt:"",className:B()("ConvoAttachesVideo__img",{"ConvoAttachesVideo__img--restriction":d})})),d&&s.createElement("div",{className:"ConvoAttachVideoResctrictionWrap"},s.createElement("div",{className:"ConvoAttachVideoIconRestriction",style:{backgroundImage:"url('".concat(null===(t=a.attach.restriction)||void 0===t||null===(n=t.card_icon)||void 0===n||null===(r=n.slice(-1).pop())||void 0===r?void 0:r.url,"')"),filter:"invert(100%)"}}),void 0!==(null===(o=a.attach.restriction)||void 0===o?void 0:o.title)&&s.createElement("div",null,a.attach.restriction.title))),s.createElement(S.Dropdown,{classNames:{wrapper:"ConvoAttachVideo__dropdown"},content:s.createElement(L.ActionsMenu,{className:"ConvoActionsMenu"},O),align:"center",position:"left",hideOnClick:!0},s.createElement("button",{className:"ConvoAttachVideo__action","aria-label":g.use("me_actions_more")},s.createElement(N.default,null)))),c&&l&&s.createElement("div",{className:"ConvoAttachesVideos__restore"},s.createElement("div",{className:"ConvoAttachesVideos__restore-button",onClick:function(){v("restore",a)}},g.use("me_attach_action_restore"))),A&&s.createElement("div",{className:"ConvoAttachesVideos__info"},A)),s.createElement("div",{className:"ConvoAttachesVideo__title"},w),s.createElement("div",{className:"ConvoAttachesVideo__views"},g.use("me_convo_attaches_video_views",{num:k,values:{count:g.formatNumber(k,"short")}})))};var H=n(55869);const K=(0,H.makeIcon)("Icon24MessageArrowRightOutline","message_arrow_right_outline_24","0 0 24 24",'<symbol fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="message_arrow_right_outline_24"><g clip-rule="evenodd" fill="currentColor" fill-rule="evenodd"><path d="M12.016 4.9c-3.077 0-5.702 1.444-7.065 3.5a.9.9 0 0 1-1.5-.995C5.178 4.799 8.395 3.1 12.016 3.1c5.324 0 9.884 3.729 9.884 8.607 0 4.878-4.56 8.607-9.884 8.607-1.173 0-2.3-.178-3.348-.506C7.42 20.961 5.616 21.513 3.42 21.6c-.927.036-1.598-.927-1.209-1.792.529-1.183 1.197-2.403 1.298-3.72a8.205 8.205 0 0 1-.34-.54.9.9 0 0 1 1.56-.898c.124.216.262.426.413.629a.9.9 0 0 1 .177.537c0 1.38-.54 2.684-1.099 3.92 1.714-.194 2.835-.75 3.513-1.547a.9.9 0 0 1 1.002-.26c1 .376 2.11.586 3.28.586 4.6 0 8.085-3.172 8.085-6.807 0-3.635-3.485-6.807-8.084-6.807z" /><path d="M10.864 8.264a.9.9 0 0 1 1.272 0l2.6 2.6a.9.9 0 0 1 0 1.272l-2.6 2.6a.9.9 0 0 1-1.272-1.272l1.063-1.064H2.9a.9.9 0 1 1 0-1.8h9.027l-1.063-1.064a.9.9 0 0 1 0-1.272z" /></g></symbol>',24,24);var G=function(e){e.document;var t=e.messageId,n=e.goToMessage,r=(0,h.useBrowserEnv)().lang,o=(0,s.useCallback)((function(e){switch(e){case"share":return;case"go_to_message":return void n(t);default:return(0,g.exhaustivenessCheck)(e)}}),[t,n]);return s.createElement(L.ActionsMenu,null,s.createElement(L.ActionsMenuAction,{title:r.use("me_attach_action_go_to_message"),leftIcon:s.createElement(K,null),onClick:function(){return o("go_to_message")},type:"primary"}))},z=function(e){e.audio;var t=e.messageId,n=e.goToMessage,r=(0,h.useBrowserEnv)().lang,o=(0,s.useCallback)((function(e){switch(e){case"share":return;case"go_to_message":return void n(t);default:return(0,g.exhaustivenessCheck)(e)}}),[t,n]);return s.createElement(L.ActionsMenu,null,s.createElement(L.ActionsMenuAction,{onClick:function(){return o("go_to_message")},title:r.use("me_attach_action_go_to_message"),leftIcon:s.createElement(K,null),type:"primary"}))},q=n(83704);const W=(0,H.makeIcon)("Icon20ChevronRightOutline","chevron_right_outline_20","0 0 20 20",'<symbol viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" id="chevron_right_outline_20"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.47 4.217a.75.75 0 0 0 0 1.06L12.185 10l-4.716 4.72a.75.75 0 1 0 1.062 1.06l5.245-5.25a.75.75 0 0 0 0-1.061L8.531 4.218a.75.75 0 0 0-1.061-.001z" fill="currentColor" /></symbol>',20,20);var $=function(e){var t,n=e.links,r=e.tailWatchBind,o=e.goToMessage,a=(0,h.useBrowserEnv)().lang;return t=new Set,s.createElement("ul",null,n.map((function(e,i){var c=i===n.length-1,l="".concat(e.cmid,"_").concat(e.attach.url),u=t.has(l)?"".concat(l,"_").concat(i):l;return t.add(l),s.createElement("li",{key:u},c&&r&&s.createElement("div",{ref:r}),s.createElement(x.Link,{href:e.attach.url,target:"_blank",className:"ConvoAttachesLink"},s.createElement("div",null,s.createElement("div",{className:"ConvoAttachesLink__image-container"},function(e){var t="";if(e.image){var n=(0,P.preview)(e,48,48,!0);n&&(t=n.url)}return t?s.createElement("img",{src:t,className:"ConvoAttachesLink__image"}):s.createElement("div",{className:"ConvoAttachesLink__image"})}(e.attach))),s.createElement("div",{className:"ConvoAttachesLink__content"},s.createElement("div",{className:"ConvoAttachesLink__name"},e.attach.title),s.createElement("div",{className:"ConvoAttachesLink__url"},e.attach.url)),s.createElement("div",{className:"ConvoAttachesLink__actions"},s.createElement(q.Tooltip,{content:a.use("me_convo_attaches_to_message"),position:"top",align:"center",delay:500},s.createElement("div",{className:"ConvoAttachesLink__button",onClick:function(t){t.stopPropagation(),t.preventDefault(),o(e.messageId)}},s.createElement(W,null))))))})))},J=function(e){var t=e.convo,n=e.goToMessage,a=e.className,p=(0,s.useState)("photos"),m=(0,o.default)(p,2),g=m[0],b=m[1],k=function(e){var t=(0,s.useState)(null),n=(0,o.default)(t,2),a=n[0],c=n[1],l=(0,h.useBrowserEnv)().api,u=(0,h.useOwner)(),d=(0,s.useCallback)(function(){var t=(0,r.default)(i().mark((function t(n){var r,o,s,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null!==(r=(d=a||{})[n])&&void 0!==r&&r.isLoading||null!==(o=d[n])&&void 0!==o&&o.isAllLoaded)){t.next=3;break}return t.abrupt("return");case 3:return E(d,!0,n),c(_({},d)),t.next=7,w(l,e,u.id,n,(null===(s=d[n])||void 0===s?void 0:s.cursorNextLoad)||void 0);case 7:f=t.sent,A(d,f),E(d,!1,n),c(_({},d));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[l,a,u.id,e]);return{attaches:a,getNextPage:d}}(t.peerId),C=k.attaches,I=k.getNextPage,O=(0,s.useRef)(),P=(0,h.useBrowserEnv)(),x=P.lang,M=P.api,j=(0,h.useOwner)(),L=(0,s.useCallback)((function(e){if(e)return O.current=new IntersectionObserver(function(){var e=(0,r.default)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t[0])||void 0===n||!n.isIntersecting){e.next=3;break}return e.next=3,I(g);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),O.current.observe(e),function(){var e;return null===(e=O.current)||void 0===e?void 0:e.disconnect()}}),[g,I]),R=function(e){e!==g&&(C&&!C[e]&&I(e),b(e))},T=(0,s.useRef)(null),F=function(){var e=(0,r.default)(i().mark((function e(t){var r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T.current=t,e.next=4,M.fetch("messages.getById",{message_ids:t.toString(),group_id:(0,y.getOwnerGroupId)(j.id),extended:0});case 4:if(r=e.sent,a=(0,o.default)(r.items,1),s=a[0]){e.next=9;break}throw new Error("Неожиданный ответ сервера");case 9:if(f.resolveId(s.id)===T.current){e.next=11;break}return e.abrupt("return");case 11:n(f.resolveCmid(s.conversation_message_id)),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();if((0,s.useEffect)((function(){null===C&&I(g)})),!C)return null;var V=C[g];return s.createElement("div",{className:B()("ConvoAttachments",a)},s.createElement(c.Tabs,{className:"ConvoAttachments_tabs"},s.createElement(c.TabsItem,{onClick:function(){return R("photos")},selected:"photos"===g},x.use("me_convo_attaches_type_photo")),s.createElement(c.TabsItem,{onClick:function(){return R("videos")},selected:"videos"===g},x.use("me_convo_attaches_type_video")),s.createElement(c.TabsItem,{onClick:function(){return R("audios")},selected:"audios"===g},x.use("me_convo_attaches_type_music")),s.createElement(c.TabsItem,{onClick:function(){return R("docs")},selected:"docs"===g},x.use("me_convo_attaches_type_doc")),s.createElement(c.TabsItem,{onClick:function(){return R("links")},selected:"links"===g},x.use("me_convo_attaches_type_links"))),C&&s.createElement("div",{className:"ConvoAttachments__block"},function(){var e,n;if(null==V||!V.items||0===(null==V?void 0:V.items.length))return null;switch(g){case"audios":return s.createElement("ul",{className:"ConvoAttachments__list"},null==V?void 0:V.items.map((function(e,t,n){var r=e.attach,o=n.length===t+1&&!(null!=V&&V.isLoading)&&!(null!=V&&V.isAllLoaded);return"Audio"!==r.kind?null:s.createElement("li",{key:"".concat(e.cmid,"-").concat(r.id)},o&&s.createElement("div",{ref:L}),s.createElement("div",{className:"ConvoAttachments__itemContainer"},s.createElement("div",{className:"ConvoAttachments__item"},s.createElement(l.AttachAudio,{audio:r})),s.createElement(S.Dropdown,{hideOnClick:!0,content:s.createElement(z,{audio:r,messageId:e.messageId,goToMessage:F}),align:"right",position:"bottom"},s.createElement("button",{className:"ConvoAttachments__itemMenuButton"},s.createElement(N.default,null)))))})));case"docs":return s.createElement("ul",{className:"ConvoAttachments__list"},null==V?void 0:V.items.map((function(e,t,n){var r=e.attach,o=n.length===t+1&&!(null!=V&&V.isLoading)&&!(null!=V&&V.isAllLoaded);return"Doc"!==r.kind?null:s.createElement("li",{className:"ConvoAttachments__listItem ConvoAtachments__docItem",key:"".concat(e.cmid,"-").concat(r.id)},o&&s.createElement("div",{ref:L}),s.createElement("div",{className:"ConvoAttachments__itemContainer"},s.createElement("div",{className:"ConvoAttachments__item"},s.createElement(u.AttachDoc,{doc:r,withoutPreview:!0})),s.createElement(S.Dropdown,{hideOnClick:!0,content:s.createElement(G,{document:r,messageId:e.messageId,goToMessage:F}),align:"center",position:"left"},s.createElement("button",{className:"ConvoAttachments__itemMenuButton"},s.createElement(N.default,null)))))})));case"links":var r=C[g];if(!r)return null;var o=!r.isAllLoaded&&!r.isLoading;return s.createElement($,{links:r.items,goToMessage:F,tailWatchBind:o?L:void 0});case"photos":var a=null===(e=C[g])||void 0===e?void 0:e.items;if(!a)return null;var i=!(null!=V&&V.isLoading||null!=V&&V.isAllLoaded);return s.createElement(D,{photos:a,tailWatchBind:i?L:void 0,isCasper:d.isCasper(t),goToMessage:F},s.createElement("div",{ref:L}));case"videos":var c=null===(n=C[g])||void 0===n?void 0:n.items;if(!c)return null;var f=!(null!=V&&V.isLoading||null!=V&&V.isAllLoaded);return s.createElement(U,{videos:c,tailWatchBind:f?L:void 0,goToMessage:F},s.createElement("div",{ref:L}));default:return null}}(),(!V||V.isLoading)&&s.createElement(v.OptimizedSpinner,{className:"ConvoAttachments__loader"}),V&&!V.isLoading&&0===V.items.length&&s.createElement("div",{className:"ConvoAttachments__empty"},x.use("me_convo_attaches_empty_type"))))}},84839:(e,t,n)=>{"use strict";n.d(t,{Dropdown:()=>g});var r=n(14957),o=n(22559),a=n(56568),i=n(16790),s=n(67294),c=n(29697),l=n(27415),u=n(20700),d=n.n(u),f=n(21705),v=n(84970),p=n(17388),h=["openType","delay","classNames","content","children","hideOnClick","open","onOpen","onClose","forceUpdateContent"],m=(0,s.createContext)(void 0),g=function(e){var t,n=e.openType,u=void 0===n?"hover":n,g=e.delay,y=e.classNames,b=void 0===y?{}:y,_=e.content,w=e.children,k=e.hideOnClick,C=e.open,E=void 0!==C&&C,A=e.onOpen,I=e.onClose,O=e.forceUpdateContent,P=(0,i.default)(e,h),x=(0,s.useState)(!1),S=(0,a.default)(x,2),M=S[0],j=S[1],N=(0,v.usePrevious)(M),L=(0,s.useState)(_),D=(0,a.default)(L,2),R=D[0],T=D[1],B=function(e){var t=e.open,n=e.openType,r=e.delay,o=e.childOpen,i=(0,s.useState)("closed"),c=(0,a.default)(i,2),l=c[0],u=c[1],d=(0,s.useRef)(null),p=(0,s.useRef)(null),h=function(e){var t=e.delay,n=e.openType,r=e.displayState,o=e.setDisplayState,a=e.$content,i=e.$trigger,c=e.childOpen,l=(0,s.useRef)(null),u=(0,s.useRef)(null),d=(0,s.useContext)(m),f=(0,s.useCallback)((function(){l.current&&(window.clearTimeout(l.current),l.current=null)}),[]),v=(0,s.useCallback)((function(){u.current&&(window.cancelAnimationFrame(u.current),u.current=null)}),[]),p=(0,s.useCallback)((function(){f(),v()}),[v,f]),h=(0,s.useCallback)((function(){"hover"===n&&(p(),o((function(e){return"opening"===e?"closed":"closing"})),null==d||d.setChildOpen(!1))}),[d,n,p,o]),g=(0,s.useCallback)((function(){"hover"!==n||l.current||(t?l.current=window.setTimeout((function(){return o("opening")}),t):o("opening"),null==d||d.setChildOpen(!0))}),[t,d,n,o]);return(0,s.useEffect)((function(){var e=function(){var e,t;null!==(e=i.current)&&void 0!==e&&e.matches(":hover")||null!==(t=a.current)&&void 0!==t&&t.matches(":hover")||c?g():h()},t=function(){v(),u.current=window.requestAnimationFrame(e)};return"hover"!==n||"opening"!==r&&"opened"!==r||(t(),document.addEventListener("mousemove",t,{passive:!0}),document.addEventListener("wheel",t,{passive:!0})),function(){document.removeEventListener("mousemove",t),document.removeEventListener("wheel",t)}}),[a,i,v,c,r,h,g,n]),(0,s.useEffect)((function(){return function(){p()}}),[p]),{onMouseOver:g,hideOnHover:h}}({delay:r,openType:n,displayState:l,setDisplayState:u,$content:d,$trigger:p,childOpen:o}),g=h.hideOnHover,y=h.onMouseOver,b=function(e){var t=e.$content,n=e.openType,r=e.setDisplayState,o=(0,s.useCallback)((function(e){"click"===n&&(null==e||e.stopPropagation(),r((function(e){switch(e){case"opening":return"closed";case"closed":return"opening";case"opened":case"closing":return"closing";default:return(0,f.exhaustivenessCheck)(e)}})))}),[n,r]);return(0,s.useEffect)((function(){var e=function(e){e.stopPropagation(),"click"===n&&t.current&&e.target instanceof Node&&!t.current.contains(e.target)&&o()};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}),[t]),{onClick:o}}({$content:d,openType:n,setDisplayState:u}).onClick,_=(0,v.usePrevious)(t);(0,s.useEffect)((function(){_!==t&&(t||"closed"===l?t&&"opened"!==l&&u("opening"):u(d.current?"closing":"closed"))}),[t,_,l,d]);var w=(0,s.useCallback)((function(){u("opened")}),[]),k=(0,s.useCallback)((function(){u("closed")}),[]),C=(0,s.useCallback)((function(){b(),g()}),[g,b]);return{displayState:l,$content:d,$trigger:p,onClick:b,onHover:y,handleHide:C,handleOpened:w,handleClosed:k}}({open:E,openType:(0,p.useDeviceData)().isTouchOnly&&"hover"===u?"click":u,delay:g,childOpen:M}),F=B.displayState,U=B.$content,V=B.$trigger,H=B.onClick,K=B.onHover,G=B.handleHide,z=B.handleOpened,q=B.handleClosed,W=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),k&&G()}),[k,G]);return(0,s.useEffect)((function(){"opened"===F&&(null==A||A()),"closed"===F&&(null==I||I())}),[F,I,A]),(0,s.useEffect)((function(){var e=!M&&N;(O||!["closing","opening"].includes(F)&&!e)&&T(_)}),[M,_,F,N,O]),s.createElement("div",{className:d()("DropdownReforged",b.wrapper,(t={},(0,o.default)(t,b.wrapperOpened||"DropdownReforged--opened","opened"===F),(0,o.default)(t,b.wrapperClosed||"DropdownReforged--closed","closed"===F),t))},s.createElement(m.Provider,{value:{setChildOpen:j}},s.createElement(l.Popper,(0,r.default)({ref:V},P,{portalClassName:b.portal,onMouseEnter:K,open:"closed"!==F,content:s.createElement(c.default,{nodeRef:U,in:"opening"===F||"opened"===F,addEndListener:function(e){var t;return null===(t=U.current)||void 0===t?void 0:t.addEventListener("transitionend",e,!1)},mountOnEnter:!0,unmountOnExit:!0,appear:!0,classNames:"".concat(b.contentWrapper||"DropdownReforged__contentWrapper","-"),onEntered:z,onExited:q},s.createElement("div",{ref:U,className:b.contentWrapper||"DropdownReforged__contentWrapper",onClick:W},R))}),s.createElement("div",{className:"DropdownReforged__trigger",onMouseOver:K,onMouseEnter:K,onClick:H},w))))}},56151:(e,t,n)=>{"use strict";n.d(t,{LayerProvider:()=>a,useLayer:()=>i});var r=n(67294),o=(n(73935),(0,r.createContext)({})),a=function(e){var t=e.layer,n=e.children;return r.createElement(o.Provider,{value:{layer:t}},n)},i=function(){return(0,r.useContext)(o).layer||void 0}},40637:(e,t,n)=>{"use strict";n.d(t,{Link:()=>l});var r=n(14957),o=n(16790),a=n(67294),i=n(84970),s=n(21705),c=["children","href","payload","download","target","rel","onNavigate","stopPropagation"],l=(0,a.forwardRef)((function(e,t){var n=e.children,l=e.href,f=e.payload,v=e.download,p=e.target,h=e.rel,m=e.onNavigate,g=e.stopPropagation,y=void 0===g||g,b=(0,o.default)(e,c),_=(0,i.useBrowserEnv)(),w=_.navigate,k=function(e,t){var n=e.replace(".","\\."),r=(0,s.safeDecodeURI)(t);if(/^\/[^/]/.test(r)||new RegExp("^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?(".concat(n,"|vk\\.me|vk\\.cc)(\\/.*)?")).test(r)){var o=!/^(https?:\/\/)?([a-z0-9_\-.]+\.)?(vk\.me|vk\.cc)(\/.*)?/.test(r),a=o?"_self":"_blank";return{url:t,shouldNavigate:o,target:a,rel:"_blank"===a?"noopener noreferrer":void 0}}return{url:d(t)?t:u(t,e),shouldNavigate:!1,target:"_blank",rel:"noopener noreferrer"}}(_.vkDomain,l);return a.createElement("a",(0,r.default)({},b,{href:k.url,target:p||k.target,rel:h||k.rel,ref:t,onClick:function(e){if(y&&e.stopPropagation(),!v)if(b.onClick)b.onClick(e);else{if(!k.shouldNavigate)return;w.openLink(l,f||null,e),null==m||m()}}}),n)}));function u(e,t){return"https://".concat(t,"/away.php?to=").concat(encodeURIComponent((0,s.safeDecodeURI)(e)),"&utf=1")}function d(e){return/^mailto:/.test(e)}},7731:(e,t,n)=>{"use strict";n.d(t,{ModalContext:()=>i,ModalsProvider:()=>s});var r=n(80312),o=n(56568),a=n(67294),i=(0,a.createContext)({}),s=function(e){var t=e.children,n=e.modals,s=e.modalsStack,c=(0,a.useCallback)((function(e){var t=s.currentElement,n=0;if((null==t?void 0:t.groupId)!==e)throw Error("Пытаетесь закрыть группу модалок, которая закрыта");for(;(null===(r=s.currentElement)||void 0===r?void 0:r.groupId)===e;){var r;n+=1,s.goBack()}s.pop(n)}),[s]),l=(0,a.useCallback)((function(e){var t=n.getModalParams(e),r=t.groupId,o=t.isSubModal;s.push({modalId:e,groupId:r,isSubModal:o})}),[s,n]),u=(0,a.useCallback)((function(e){var t=s.currentElement;if((null==t?void 0:t.modalId)!==e)throw Error("Пытаетесь закрыть модалку, которая закрыта");s.pop()}),[s]),d=(0,a.useState)([]),f=(0,o.default)(d,2),v=f[0],p=f[1];return(0,a.useLayoutEffect)((function(){return s.subscribe((function(e){var t=e.action,n=e.payload;"add"===t&&(e.payload.isSubModal?p([].concat((0,r.default)(v),[n.modalId])):p([n.modalId])),"remove"===t&&p(v.filter((function(e){return!n.find((function(t){return e===t.modalId}))})))}))}),[s,v]),a.createElement(i.Provider,{value:{openedModals:v,openModal:l,closeModal:u,closeGroup:c,getModalGroup:n.getModalGroup,createModal:n.createModal,createGroup:n.createGroup}},t)}},71851:(e,t,n)=>{"use strict";n.d(t,{OptimizedSpinner:()=>d});var r=n(22559),o=n(67294),a=n(20700),i=n.n(a),s=n(58346),c=n(54632);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(e){var t=e.className,n=e.size,r=void 0===n?"small":n,a=e.intersectionOptions,l=e.onIntersection,d=(0,c.useInView)(u(u({},a),{},{threshold:.01})),f=d.ref,v=d.inView;return(0,o.useEffect)((function(){v&&l&&l()}),[v]),o.createElement("div",{ref:f,className:i()("OptimizedSpinner",t)},v&&o.createElement(s.Spinner,{size:r}))}},88751:(e,t,n)=>{"use strict";n.d(t,{ConvoAudiosPlaylistContext:()=>a,ConvoAudiosPlaylistProvider:()=>i});var r=n(67294),o=n(19423),a=r.createContext((function(){})),i=function(e){var t=e.convo,n=e.children,i=(0,r.useRef)(t);i.current=t;var s=(0,r.useCallback)((function(){return new o.ConvoAudiosPlaylist(i.current)}),[]);return r.createElement(a.Provider,{value:s},n)}},27415:(e,t,n)=>{"use strict";n.d(t,{Popper:()=>g});var r=n(14957),o=n(22559),a=n(56568),i=n(16790),s=n(67294),c=n(20700),l=n.n(c),u=n(26954),d=n(84970),f=n(87075),v=n(56151),p=["open","position","mode","align","adaptation","content","portalClassName","children","portalTarget"];function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=s.forwardRef((function(e,t){var n,o=e.open,c=void 0===o||o,h=e.position,g=void 0===h?"auto":h,y=e.mode,b=void 0===y?"side":y,_=e.align,w=void 0===_?"auto":_,k=e.adaptation,C=e.content,E=e.portalClassName,A=e.children,I=e.portalTarget,O=(0,i.default)(e,p),P=(0,v.useLayer)(),x=(0,s.useState)(null),S=(0,a.default)(x,2),M=S[0],j=S[1],N=(0,d.useCombinedRefs)(t),L=(0,s.useState)(null),D=(0,a.default)(L,2),R=D[0],T=D[1],B=(0,s.useState)(null),F=(0,a.default)(B,2),U=F[0],V=F[1],H=(0,s.useState)(null),K=(0,a.default)(H,2),G=K[0],z=K[1],q=m(m({},A.props),{},{ref:N}),W=(0,s.useCallback)((function(e){e&&j(e)}),[]);return(0,s.useEffect)((function(){if(N.current){var e=function(e,t,n,r,o,a,i,s){if(!a)return[null,null,null];var c="auto",l=["top","bottom"],u=["left","right"],d="fixed";if(!e)return[{top:0,left:0,width:0,height:0,position:d},o===c?"left":o,r===c?"bottom":r];var v=e.getBoundingClientRect(),p=window,h=p.innerWidth,g=p.innerHeight,y=window.scrollY||document.documentElement.scrollTop,b=window.scrollX||document.documentElement.scrollLeft;s&&(v=(0,f.getOffsetRect)(e,s),h=s.clientWidth,g=s.clientHeight,y=s.scrollTop,b=s.scrollLeft,d="absolute");var _=null==t?void 0:t.getBoundingClientRect(),w=(null==_?void 0:_.width)||0,k=(null==_?void 0:_.height)||0,C=w?Math.max(v.width,w):void 0,E=k?Math.max(v.height,k):void 0;if(r===c){var A=v.top-y;r=y+g-v.top-v.height>A?"bottom":"top"}if(o===c){var I=v.left+.5*v.width,O=b+2*h/3;o=I>=b+h/3&&I<=O?"center":I>O?"right":"left"}var P=v.left,x=v.top,S=P+v.width,M=x+v.height,j=.5*v.width,N=.5*w,L=.5*v.height,D=.5*k,R=v.width<w,T=v.height<k,B=x<k,F=M+k>g+y,U=M<k,V=x+L<D,H=x+k>g+y,K=x+L+D>g+y,G=S<w,z=S+w>h+b,q=P+j<N,W=P+j+N>h+b,$="horizontal"===i,J="vertical"===i;k&&w&&(J||(("top"===r&&B||"center"===o&&V||u.includes(o)&&U)&&(r="bottom"),("bottom"===r&&F||"center"===o&&K||u.includes(o)&&H)&&(r="top")),$||(l.includes(r)&&(u.includes(o)&&(G&&(o="left"),z&&(o="right")),"center"===o&&(W&&(o="right"),q&&(o="left"))),u.includes(r)&&(G&&(r="right",o="center"===o?o:"left"),z&&(r="left",o="center"===o?o:"right"))));if("side"===n){var Z={};switch(r){case"top":Z={width:C,top:x-k};break;case"bottom":Z={width:C,top:M};break;case"left":Z={height:E,left:P-w};break;case"right":Z={height:E,left:S}}return l.includes(r)&&R&&("right"===o&&(Z.left=S-w),"center"===o&&(Z.left=P+j-N),$&&(("center"===o&&q||"right"===o&&G)&&(Z.left=0),("center"===o&&W||"left"===o&&z)&&(Z.left=h-w+b))),u.includes(r)&&T&&("center"===o&&(Z.top=x+L-D),J&&(("center"===o&&V||u.includes(o)&&U)&&(Z.top=0),("center"===o&&K||u.includes(o)&&H)&&(Z.top=g-k+y))),[m(m({top:x,left:P},Z),{},{position:d}),o,r]}switch(r){case"top":P+=.5*v.width;break;case"right":P+=v.width,x+=.5*v.height;break;case"bottom":P+=.5*v.width,x+=v.height;break;case"left":x+=.5*v.height}return[{top:x,left:P,width:w,height:k,position:d},o,r]}(N.current,M,b,g,w,c,k,null!=I&&I.current?I.current:void 0),t=(0,a.default)(e,3),n=t[0],r=t[1],o=t[2];T(n),V(r),z(o)}}),[C,b,g,w,N,c,M,I,k]),s.createElement(s.Fragment,null,s.cloneElement(A,q),c&&s.createElement(u.Portal,(0,r.default)({},O,{ref:W,className:l()("MEPopper","MEConfig",U&&"MEPopper--align".concat((n=U,n.length>0?n.slice(0,1).toUpperCase()+n.slice(1):"")),G&&"MEPopper--".concat(G)),"data-align":U,"data-position":G,portalClassName:E,style:R||void 0,portalTarget:(null==I?void 0:I.current)||P}),C))}))},26954:(e,t,n)=>{"use strict";n.d(t,{Portal:()=>d});var r=n(14957),o=n(80312),a=n(56568),i=n(16790),s=n(67294),c=n(73935),l=n(84970),u=["children","portalClassName","portalTarget"],d=(0,s.forwardRef)((function(e,t){var n=e.children,d=e.portalClassName,f=e.portalTarget,v=(0,i.default)(e,u),p=(0,s.useState)(null),h=(0,a.default)(p,2),m=h[0],g=h[1],y=(0,l.usePrevious)(d);return(0,s.useEffect)((function(){if(m){var e,t;if(y)(e=m.classList).remove.apply(e,(0,o.default)(y.split(" ")));if(d)(t=m.classList).add.apply(t,(0,o.default)(d.split(" ")))}}),[m,d,y]),(0,s.useLayoutEffect)((function(){if(null!==f){var e=function(e,t){var n,r=document.createElement("div");e&&(n=r.classList).add.apply(n,(0,o.default)(e.split(" ")));return(t||document.body).appendChild(r)}(d,f);return g(e),function(){e.remove()}}}),[f]),m?c.createPortal(s.createElement("div",(0,r.default)({},v,{ref:t}),n),m):null}))},35544:(e,t,n)=>{"use strict";n.d(t,{Provider:()=>v});var r=n(22559),o=n(67294),a=n(14432),i=n(84970),s=n(7731),c=n(48521),l=n(24576),u=n(77673);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function(e){var t=e.children,n=e.env,r=e.featureFlags,d=e.state,v=e.dispatch,p=e.owner,h=e.appSource,m=(0,o.useCallback)((function(e){v(f({type:"CacheUpdateReceived"},e))}),[v]),g=(0,o.useMemo)((function(){return f({viewer:a.safeGet(d.peers,d.viewer.id)},d.viewer)}),[d.peers,d.viewer]);return o.createElement(i.BrowserEnvProvider,{value:n},o.createElement(c.KeyBoardHandlersProvider,null,o.createElement(l.RouterProvider,null,o.createElement(s.ModalsProvider,{modals:n.modals.system,modalsStack:n.modals.stack},o.createElement(i.DispatchProvider,{value:v},o.createElement(i.FeatureFlagsProvider,{value:r},o.createElement(i.HelpHintsProvider,{value:d.helpHints},o.createElement(i.OnlinesProvider,{value:d.onlines},o.createElement(i.TypingsProvider,{value:d.typings},o.createElement(i.PeersProvider,{value:d.peers},o.createElement(i.OwnerProvider,{value:p},o.createElement(i.ConvosProvider,{value:d.convos},o.createElement(i.ConvosSearchIndexProvider,{value:d.convosSearchIndex},o.createElement(i.ViewerProvider,{value:g},o.createElement(i.InsertIntoCacheProvider,{value:m},o.createElement(u.ComposerDraftsContext.Provider,{value:d.composerDrafts},o.createElement(i.AppSourceProvider,{value:h},t)))))))))))))))))}},24576:(e,t,n)=>{"use strict";n.d(t,{RouterProvider:()=>s,useRouter:()=>c,useConvoRoute:()=>l});var r=n(56568),o=n(84970),a=n(67294),i=(0,a.createContext)({}),s=function(e){var t=e.children,n=(0,o.useBrowserEnv)().router,s=(0,a.useState)(n.currentRoute),c=(0,r.default)(s,2),l=c[0],u=c[1];return(0,a.useLayoutEffect)((function(){var e=n.subscribe((function(e){u(e)}));return function(){return e()}}),[n]),a.createElement(i.Provider,{value:{router:n,route:l}},t)},c=function(){var e=(0,a.useContext)(i),t=e.route,n=e.router;return{route:t,navigate:n.push,back:n.back,forward:n.forward,replace:n.replace}},l=function(){var e=c().route;if("ConvoRoute"!==e.kind)throw Error("Используйте хук только внутри роута Convo");return e}},83704:(e,t,n)=>{"use strict";n.d(t,{Tooltip:()=>v});var r=n(14957),o=n(56568),a=n(16790),i=n(67294),s=n(20700),c=n.n(s),l=n(27415),u=n(84970),d=n(17388),f=["children","content","position","align","open","onOpen","onClose","delay","backgroundColor","pointerEvents","showOnTouch"],v=function(e){var t=e.children,n=e.content,s=e.position,v=void 0===s?"auto":s,p=e.align,h=void 0===p?"auto":p,m=e.open,g=void 0!==m&&m,y=e.onOpen,b=e.onClose,_=e.delay,w=void 0===_?50:_,k=e.backgroundColor,C=e.pointerEvents,E=void 0===C?"none":C,A=e.showOnTouch,I=void 0!==A&&A,O=(0,a.default)(e,f),P=(0,u.useFeatureFlags)(),x=(0,d.useDeviceData)(),S=(0,i.useState)(g?"opened":"closed"),M=(0,o.default)(S,2),j=M[0],N=M[1],L=k||"rgba(0, 0, 0, 0.72)",D=(0,i.useRef)(null),R=(0,i.useRef)(null),T=(0,i.useRef)(null),B=function(){R.current&&clearTimeout(R.current),T.current&&clearTimeout(T.current),R.current=T.current=null},F=(0,i.useCallback)((function(){N("closed"),b&&b()}),[b]),U=(0,i.useCallback)((function(){"opened"===j?(N("is_closing"),T.current=window.setTimeout(F,200)):F()}),[j,F]),V=(0,i.useCallback)((function(){B(),R.current=window.setTimeout((function(){N("opened"),y&&y()}),w)}),[w,y]),H=(0,i.useCallback)((function(){B(),R.current=window.setTimeout(U,0)}),[U]);(0,i.useEffect)((function(){var e=D.current;return e&&(e.addEventListener("mouseenter",V),e.addEventListener("mouseleave",H)),function(){e&&(e.removeEventListener("mouseenter",V),e.removeEventListener("mouseleave",H))}}),[V,H]),(0,i.useEffect)((function(){return B}),[]),(0,i.useEffect)((function(){g?V():H()}),[g]);var K=i.createElement("div",{className:c()("METooltip",{"METooltip--removed":"is_closing"===j}),style:{"--tooltip_dark_background":L,pointerEvents:E}},n);return P.me_fc_tooltips?!I&&x.isTouchOnly?t:i.createElement(l.Popper,(0,r.default)({content:K,position:v,align:h,open:"closed"!==j,ref:D,portalClassName:"MEConfig"},O),t):t}},17388:(e,t,n)=>{"use strict";n.d(t,{UIConfigProvider:()=>l,useLayoutData:()=>u,useDeviceData:()=>d});var r=n(56568),o=n(67294),a=n(58346),i=n(84970),s=n(62276),c=n(21705),l=function(e){var t=e.scheme,n=void 0===t?"VKCOM":t,s=e.theme,l=void 0===s?"system":s,u=e.children,d=e.locale,f=e.onThemeUpdated,h=(0,o.useState)("system"!==l?l:"light"),m=(0,r.default)(h,2),g=m[0],y=m[1],b=(0,o.useRef)(null),_=(0,o.useCallback)((function(e){y(e.matches?"dark":"light")}),[]);(0,o.useEffect)((function(){var e,t=window.matchMedia("(prefers-color-scheme: dark)");switch(l){case"light":case"dark":y(l),null===(e=b.current)||void 0===e||e.call(b);break;case"system":b.current=(0,i.matchAddEventListener)(t,_),y(t.matches?"dark":"light");break;default:(0,c.exhaustivenessCheck)(l)}}),[_,l]),(0,o.useEffect)((function(){return function(){var e;return null===(e=b.current)||void 0===e?void 0:e.call(b)}}),[]),(0,o.useEffect)((function(){null==f||f(g)}),[f,g]);var w="VKCOM"===n?"light"===g?"vkcom_light":"vkcom_dark":"light"===g?a.Scheme.BRIGHT_LIGHT:a.Scheme.SPACE_GRAY,k=(0,i.useViewport)({debounced:!0}),C=(0,r.default)(k,1)[0]<640?"one-column":"two-column";return(0,o.useEffect)((function(){var e;function t(e){null==e||e.preventDefault(),window.scrollTo(0,0)}function n(){var e=.01*(window.visualViewport?window.visualViewport.height+window.visualViewport.pageTop:window.innerHeight);document.documentElement.style.setProperty("--realVh","".concat(e,"px")),p>window.innerHeight&&(t(),window.addEventListener("scroll",t))}n();var r=null!==(e=window.visualViewport)&&void 0!==e?e:window;return r.addEventListener("resize",n),window.addEventListener("orientationchange",n),function(){r.removeEventListener("resize",n),window.removeEventListener("orientationchange",n),window.removeEventListener("scroll",t)}}),[]),o.createElement(a.ConfigProvider,{locale:d,platform:a.Platform.IOS,scheme:w},o.createElement(a.ConfigProvider,{locale:d,platform:a.Platform.VKCOM,scheme:"inherit"},o.createElement(a.AdaptivityProvider,null,o.createElement(v,{value:{mode:C}},u))))};function u(){var e=(0,o.useContext)(f);if(!e)throw new Error("LayoutDataContext не добавлен в дерево Реакта!");return e}function d(){var e=(0,o.useContext)(s.AdaptivityContext);if(!e)throw new Error("AdaptivityContext не добавлен в дерево Реакта!");return{isTouchOnly:!e.deviceHasHover}}var f=o.createContext(null),v=f.Provider;var p=window.innerHeight},12869:(e,t,n)=>{"use strict";n.d(t,{isModuleKeyCombo:()=>u,isGlobalKeyCombo:()=>f,getKeyCombo:()=>v});var r,o,a,i,s=n(22559),c=n(87075);!function(e){e.Mod="Mod",e.Alt="Alt",e.Shift="Shift",e.Meta="Meta"}(o||(o={})),function(e){e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.ArrowUp="ArrowUp",e.Escape="Escape",e.Enter="Enter",e.Backspace="Backspace",e.Tab="Tab",e.Slash="/",e.PageDown="PageDown",e.PageUp="PageUp",e.Home="Home",e.End="End"}(a||(a={})),function(e){e.F="F"}(i||(i={}));var l=[o.Shift,a.ArrowDown,a.ArrowUp,a.Enter,a.Escape,a.Backspace,"".concat(o.Shift,"+").concat(a.Enter),"".concat(o.Mod,"+").concat(a.Enter),a.ArrowLeft,a.ArrowRight,a.Tab],u=function(e){return l.includes(e)},d=["".concat(o.Mod,"+").concat(i.F),"".concat(o.Mod,"+").concat(o.Shift,"+").concat(i.F),"".concat(o.Mod,"+").concat(a.Slash)],f=function(e){return d.includes(e)},v=function(e){var t=[];return Object.values(o).forEach((function(n){p[n](e)&&t.push(n)})),Object.values(a).forEach((function(n){return e.key===n&&t.push(n)})),Object.values(i).forEach((function(n){e.key.toUpperCase()!==n?e.code.slice(3)===n&&t.push(n):t.push(n)})),t.join("+")},p=(r={},(0,s.default)(r,o.Mod,(function(e){return c.isMac?e.metaKey:e.ctrlKey})),(0,s.default)(r,o.Alt,(function(e){return e.altKey})),(0,s.default)(r,o.Shift,(function(e){return e.shiftKey})),(0,s.default)(r,o.Meta,(function(e){return c.isMac?e.ctrlKey:e.metaKey})),r)},87075:(e,t,n)=>{"use strict";n.d(t,{getOffsetRect:()=>s,browser:()=>l,isMac:()=>u,getAttachForwardIndent:()=>d,getExpectedAttachWidth:()=>f,getFirstLetter:()=>v,enRuKeysMap:()=>p,getOrganiserUid:()=>h});var r=n(22559),o=n(70608),a=n.n(o),i=n(21705);function s(e,t){if("undefined"==typeof window||!(e instanceof HTMLElement))return{top:0,left:0,width:0,height:0};var n=e.getBoundingClientRect(),r=null==t?void 0:t.getBoundingClientRect(),o=document.body,a=document.documentElement,i=t?t.scrollTop:window.pageYOffset||a.scrollTop||o.scrollTop,s=(t?t.scrollLeft:window.pageXOffset)||a.scrollLeft||o.scrollLeft,c=a.clientTop||o.clientTop||0,l=a.clientLeft||o.clientLeft||0;return{top:n.top-((null==r?void 0:r.top)||0)+i-c,left:n.left-((null==r?void 0:r.left)||0)+s-l,width:n.width,height:n.height}}var c=navigator.userAgent.toLowerCase(),l={version:(c.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[/: ]([\d.]+)/)||[0,"0"])[1],safari:!/chrome/i.test(c)&&/webkit|safari|khtml/i.test(c),touch:window.matchMedia("(pointer: coarse)").matches,voiceRecordingSupported:Boolean(window.navigator.mediaDevices&&"getUserMedia"in window.navigator.mediaDevices&&(window.AudioContext||window.webkitAudioContext))},u=navigator.userAgent.includes("Macintosh;"),d=function(e){return e>0?22+10*(e-1):0};function f(e,t,n,r){var o=r+(t?0:8)-d(n);return[o,o*(e?"undefined"!=typeof window?window.devicePixelRatio:2:1)]}var v=function(e){var t=a()().exec(e);return t&&0===t.index&&t[0]?t[0]:(Array.from(e)[0]||"").toUpperCase()},p=(0,r.default)({q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","]":"ъ",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж","'":"э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б",".":"ю","/":"."},u?"\\":"`","ё");function h(e){switch(e.kind){case"filters":return e.filter;case"folders":return e.id;default:(0,i.exhaustivenessCheck)(e)}}},51225:(e,t,n)=>{"use strict";n.d(t,{resolveMiniAppId:()=>d,preview:()=>f,link:()=>v,ids:()=>p,last:()=>h,addAttach:()=>m,removeAttach:()=>g,isChatInviteLink:()=>y,isCallJoinLink:()=>b,rearrangeAttaches:()=>_});var r=n(80312),o=n(56568),a=n(21705),i=n(14432),s=n(90831),c=n(16352);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){return e};function f(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=["o","p","q","r"];if("Video"===e.kind||"Gift"===e.kind||"PollBackgroundPhoto"===e.kind||"VideoMessage"===e.kind)return e.image.find((function(e){var t=e.width,o=e.height;return t>=n&&o>=r}))||e.image.reduce((function(e,t){return!e||t.width*t.height>e.width*e.height?t:e}))||null;var s,c="Photo"===e.kind?e.sizes:e.image;return c?a?(null===(s=Array.from(c.entries()).find((function(e){var t=(0,o.default)(e,2),a=t[0],s=t[1],c=s.width,l=s.height;return i.includes(a)&&c>=n&&l>=r})))||void 0===s?void 0:s[1])||c.get("r")||c.get("q")||c.get("p")||c.get("o")||null:(null===(t=Array.from(c.entries()).find((function(e){var t=(0,o.default)(e,2),a=t[0],s=t[1],c=s.width,l=s.height;return!i.includes(a)&&c>=n&&l>=r})))||void 0===t?void 0:t[1])||c.get("w")||c.get("z")||c.get("y")||c.get("x")||c.get("m")||c.get("s")||null:null}function v(e,t){switch(e.kind){case"Photo":var n=e.accessKey?"/".concat(e.accessKey):"";return"/im?z=photo".concat(e.ownerId,"_").concat(e.id).concat(n);case"Video":var r=e.accessKey?"/".concat(e.accessKey):"";return"/im?z=video".concat(e.ownerId,"_").concat(e.id).concat(r);case"Audio":return"/audio".concat(e.ownerId,"_").concat(e.id);case"AudioPlaylist":var o=e.accessKey?"_".concat(e.accessKey):"";return"/music/".concat(e.type,"/").concat(e.ownerId,"_").concat(e.id).concat(o);case"Podcast":return"/im?z=podcast".concat(e.ownerId,"_").concat(e.id);case"Doc":return"/doc".concat(e.ownerId,"_").concat(e.id);case"Sticker":return"/stickers";case"Link":case"Article":case"InviteLink":return e.url;case"Voice":case"MoneyTransfer":case"MoneyRequest":case"Gift":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Geo":case"ActiveCall":case"VideoMessage":return"";case"Market":return"/market".concat(e.ownerId,"?w=product").concat(e.ownerId,"_").concat(e.id);case"Poll":return"/im?w=poll".concat(e.ownerId,"_").concat(e.id);case"Story":return"/im?w=story".concat(e.ownerId,"_").concat(e.id);case"Wall":return null!=t&&t.me_channels?"/#".concat(c.CHANNELS_BASE_PATH,"/").concat(e.ownerId,"?cmid=").concat(e.id):"/wall".concat(e.ownerId,"_").concat(e.id);case"WallReply":return"/wall".concat(e.ownerId,"_").concat(e.postId,"?reply=").concat(e.id)+(e.parentsStack&&e.parentsStack.length>0?"&thread=".concat(e.parentsStack.join("_")):"");case"WallHistory":return"/wall".concat(e.ownerId,"_").concat(e.id);case"MiniApp":return"/im?w=".concat(e.appLink);case"DonutLink":return"/donut/club".concat(i.toRealId(e.ownerId));default:return(0,a.exhaustivenessCheck)(e)}}function p(e){var t,n=[],r=l(e.photos||[]);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push("photo".concat(o.ownerId,"_").concat(o.id))}}catch(e){r.e(e)}finally{r.f()}var a,i=l(e.videos||[]);try{for(i.s();!(a=i.n()).done;){var s=a.value;n.push("video".concat(s.ownerId,"_").concat(s.id))}}catch(e){i.e(e)}finally{i.f()}var c,u=l(e.audios||[]);try{for(u.s();!(c=u.n()).done;){var d=c.value;n.push("audio".concat(d.ownerId,"_").concat(d.id))}}catch(e){u.e(e)}finally{u.f()}var f,v=l(e.docs||[]);try{for(v.s();!(f=v.n()).done;){var p=f.value;n.push("doc".concat(p.ownerId,"_").concat(p.id))}}catch(e){v.e(e)}finally{v.f()}return e.voice&&n.push("doc".concat(e.voice.ownerId,"_").concat(e.voice.id)),e.wall&&n.push("wall".concat(e.wall.ownerId,"_").concat(e.wall.id)),e.wallReply&&n.push("wall_reply".concat(e.wallReply.ownerId,"_").concat(e.wallReply.id)),n}function h(e){return 0===Object.keys(e).length?null:e.wallReply||e.wall||e.poll||e.donutLink||e.moneyTransfer||e.moneyRequest||e.miniApps&&e.miniApps.slice(-1)[0]||e.article||e.audioPlaylist||e.podcast||e.audios&&e.audios.slice(-1)[0]||e.voice||e.docs&&e.docs.slice(-1)[0]||e.geo||e.story||e.market||e.inviteLink||e.link||e.videos&&e.videos.slice(-1)[0]||e.graffiti||e.photos&&e.photos.slice(-1)[0]||e.videoMessage||e.sticker||e.finishedCall||e.activeCall||e.gift||null}function m(e,t){t.photos&&(e.photos=[].concat((0,r.default)(e.photos||[]),(0,r.default)(t.photos))),t.videos&&(e.videos=[].concat((0,r.default)(e.videos||[]),(0,r.default)(t.videos))),t.audios&&(e.audios=[].concat((0,r.default)(e.audios||[]),(0,r.default)(t.audios))),t.docs&&(e.docs=[].concat((0,r.default)(e.docs||[]),(0,r.default)(t.docs)))}function g(e,t){switch(t.kind){case"Audio":if(!e.audios)break;var n=(0,a.toNonEmpty)(e.audios.filter((function(e){return e.id!==t.id})));n?e.audios=n:delete e.audios;break;case"Doc":if(!e.docs)break;var r=(0,a.toNonEmpty)(e.docs.filter((function(e){return e.id!==t.id})));r?e.docs=r:delete e.docs;break;case"Photo":if(!e.photos)break;var o=(0,a.toNonEmpty)(e.photos.filter((function(e){return e.id!==t.id})));o?e.photos=o:delete e.photos;break;case"Video":if(!e.videos)break;var i=(0,a.toNonEmpty)(e.videos.filter((function(e){return e.id!==t.id})));i?e.videos=i:delete e.videos;break;case"Voice":if(!e.voice)break;delete e.voice;break;default:(0,a.exhaustivenessCheck)(t)}}function y(e){return e.startsWith(s.CHAT_INVITE_LINK_URL_BASE)||e.startsWith(s.VKME_CHAT_INVITE_LINK_URL_BASE)}function b(e){return e.startsWith(s.CALL_JOIN_LINK_URL_BASE)}function _(e,t,n){var r=t.currentPosition,o=t.newPosition;switch(n){case"photos":var i=e[n];if(!i)return;var s=i[r];if(!s)return;i.splice(r,1),i.splice(o,0,s),e[n]=i;break;case"videos":var c=e[n];if(!c)return;var l=c[r];if(!l)return;c.splice(r,1),c.splice(o,0,l),e[n]=c;break;case"audios":var u=e[n];if(!u)return;var d=u[r];if(!d)return;u.splice(r,1),u.splice(o,0,d),e[n]=u;break;case"docs":var f=e[n];if(!f)return;var v=f[r];if(!v)return;f.splice(r,1),f.splice(o,0,v),e[n]=f;break;default:(0,a.exhaustivenessCheck)(n)}}},73974:(e,t,n)=>{"use strict";function r(e,t,n){return encodeURIComponent("".concat("app"+e+(n?"_"+n:""),"#").concat(t))}function o(e){return e}n.d(t,{createAppUrl:()=>r,resolveId:()=>o})},89018:(e,t,n)=>{"use strict";n.d(t,{DEFAULT_DRAFT:()=>i,isEmpty:()=>s,getNormalForward:()=>c,deleteDraftsWithKind:()=>l});var r=n(56568),o=n(80312),a=n(14432),i={text:"",attaches:{}};function s(e,t){var n=0!==Object.keys(e.attaches).length;return 0===t.length&&!e.forward&&!n}function c(e,t){if(e.forward&&e.forward.kind===t){var n=(0,o.default)(e.forward.items).filter((function(e){return"Normal"===e.kind}));return n[0]?[n[0]].concat((0,o.default)(n.slice(1))):void 0}}function l(e){return Object.entries(e).reduce((function(e,t){var n=(0,r.default)(t,2),o=n[0],i=n[1];return"kind"in i||(e[a.resolveId(+o)]=i),e}),{})}},94170:(e,t,n)=>{"use strict";function r(e){return!Number.isNaN(e)&&e||(e=0),e}n.d(t,{resolveId:()=>r})},78664:(e,t,n)=>{"use strict";function r(e){return Number.isNaN(e)&&(e=0),e}function o(e){return Number.isNaN(e)&&(e=0),e}n.d(t,{resolveStickerPackId:()=>r,resolveStickerId:()=>o})},47860:(e,t,n)=>{"use strict";n.d(t,{dictionaryLatinConvert:()=>v,toTranslit:()=>p,toLocalCase:()=>h});var r=n(56568),o=n(22559);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={u1072:"a",u1073:"b",u1074:"v",u1075:"g",u1076:"d",u1077:"e",u1105:"yo",u1078:"zh",u1079:"z",u1080:"i",u1081:"y",u1082:"k",u1083:"l",u1084:"m",u1085:"n",u1086:"o",u1087:"p",u1088:"r",u1089:"s",u1090:"t",u1091:"u",u1092:"f",u1093:"kh",u1094:"ts",u1095:"ch",u1096:"sh",u1097:"shch",u1098:"'",u1099:"y",u1100:"'",u1101:"e",u1102:"yu",u1103:"ya"},u=c(c({},l),{},{u1093:"h",u1097:"sh",u1098:"",u1100:"",u1105:"e"}),d={u102:"а",u44:"б",u100:"в",u117:"г",u108:"д",u116:"е",u92:"ё",u59:"ж",u112:"з",u98:"и",u113:"й",u114:"к",u107:"л",u118:"м",u121:"н",u106:"о",u103:"п",u104:"р",u99:"с",u110:"т",u101:"у",u97:"ф",u91:"х",u119:"ц",u120:"ч",u105:"ш",u111:"щ",u93:"ъ",u109:"ь",u115:"ы",u39:"э",u46:"ю",u122:"я",u60:"б",u126:"ё",u58:"ж",u123:"х",u125:"ъ",u34:"э",u62:"ю",u64:'"',u35:"№",u36:";",u37:"%",u94:":",u38:"?",u63:",",u47:"."},f={yo:"ё",YO:"Ё",zh:"ж",ZH:"Ж",kh:"х",KH:"Х",ts:"ц",TS:"Ц",ch:"ч",CH:"Ч",sch:"щ",SCH:"Щ",shch:"щ",SHCH:"Щ",sh:"ш",SH:"Ш",eh:"э",EH:"Э",yu:"ю",YU:"Ю",ya:"я",YA:"Я","'":"ь",a:"а",A:"А",b:"б",B:"Б",v:"В",g:"г",G:"Г",d:"д",D:"Д",e:"е",E:"Е",z:"з",Z:"З",i:"и",I:"И",j:"й",J:"Й",k:"к",K:"К",l:"л",L:"Л",m:"м",M:"М",n:"н",N:"Н",o:"о",O:"О",p:"п",P:"Р",r:"р",R:"Р",s:"с",S:"С",t:"т",T:"Т",u:"у",U:"У",f:"ф",F:"Ф",h:"х",H:"Х",c:"ц",C:"Ц",y:"ы",Y:"Ы"};function v(e){return function(e){var t=e.dictionary,n=e.value;return Object.entries(t).reduce((function(e,t){var n=(0,r.default)(t,2),o=n[0],a=n[1];return e.replace(new RegExp(o,"g"),a)}),n)}({value:e.value,dictionary:f})}function p(e,t){e=e.toLowerCase().trim();var n=[l,u];return t&&n.push(d),n.reduce((function(t,n){var r=m(e,n);return r===e||t.includes(r)||t.push(r),t}),[])}function h(e){return m(e=e.toLowerCase().trim(),d)}function m(e,t){var n,r="",o=a(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,s=t["u"+i.codePointAt(0)];r+=void 0!==s?s:i}}catch(e){o.e(e)}finally{o.f()}return r}},33600:(e,t,n)=>{"use strict";n.d(t,{create:()=>d,add:()=>f,search:()=>v,peerWords:()=>m});var r=n(80312),o=n(22559),a=n(47860),i=n(21705),s=n(40075);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=Symbol("items");function d(){return(0,o.default)({},u,new Set)}function f(e,t,n){if(Array.isArray(t))t.forEach((function(t){return f(e,t,n)}));else{var r=n(t),o=r.id,a=r.strings;(0,s.getWordsVariants)(a).forEach((function(t){var n=e;n[u].add(o),Array.from(t.trim().toLowerCase()).forEach((function(e){var t=n[e];t||(t=n[e]=d()),t[u].add(o),n=t}))}))}return e}function v(e,t){var n=p(e,g(t)),o=p(e,g(a.toLocalCase(t))),i=p(e,a.toTranslit(t));return new Set([].concat((0,r.default)(n),(0,r.default)(o),(0,r.default)(i)))}function p(e,t){var n,o=null,a=c(t);try{for(a.s();!(n=a.n()).done;){var i=h(e,n.value);if(o){var s,l=c(o);try{for(l.s();!(s=l.n()).done;){var u=s.value;i.has(u)||o.delete(u)}}catch(e){l.e(e)}finally{l.f()}}else o=new Set((0,r.default)(i))}}catch(e){a.e(e)}finally{a.f()}return o||new Set}function h(e,t){var n,r=e,o=c(t.trim().toLowerCase());try{for(o.s();!(n=o.n()).done;){var a=r[n.value];if(!a)return new Set;r=a}}catch(e){o.e(e)}finally{o.f()}return r[u]}function m(e){var t=[];switch(e.kind){case"Chat":t.push.apply(t,(0,r.default)(g(e.title)));break;case"Group":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,r.default)(g(e.name)));break;case"User":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,r.default)(g(e.firstName))),t.push.apply(t,(0,r.default)(g(e.lastName)));break;case"Contact":t.push.apply(t,(0,r.default)(g(e.name)));break;default:(0,i.exhaustivenessCheck)(e)}return t}function g(e){return e.trim().toLowerCase().split(/\s+/g)}},40075:(e,t,n)=>{"use strict";n.d(t,{getWordsVariants:()=>i});var r=n(47860);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t,n=[],a=o(e);try{var i=function(){var e=t.value,o=e.replace(/ё/g,"е").replace(/Ё/g,"Е");o!==e&&n.push(o),r.toTranslit(e,!0).forEach((function(t){t!==e&&n.push(t)})),n.push(e)};for(a.s();!(t=a.n()).done;)i()}catch(e){a.e(e)}finally{a.f()}return n}},3460:(e,t,n)=>{"use strict";n.d(t,{fromApiAttach:()=>y,fromApiConvoAttach:()=>b,fromApiWallAttach:()=>_,fromApiWallReplyAttach:()=>w,fromApiDoc:()=>C,fromApiPhoto:()=>E,fromApiVideo:()=>A,fromApiAudio:()=>S,fromApiVoice:()=>M,fromApiPoll:()=>U,apiAttachWallOwnerId:()=>K});var r=n(16790),o=n(93209),a=n(22559),i=n(80312),s=n(51225),c=n(14432),l=n(80662),u=n(41450),d=n(21705),f=n(78399),v=["type","src"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t,n){if(0===e.length)return{};var r,o,a,l,d,v,p,g,y,b,O,j,V,H,z={},q=function(e){z.unknown=[].concat((0,i.default)(z.unknown||[]),[{data:e,kind:"Unknown"}])},W=m(e);try{for(W.s();!(r=W.n()).done;){var $=r.value;switch($.type){case"photo":if(!$.photo){q($);break}var J=E($.photo,n);if(!J){q($);break}z.photos=[].concat((0,i.default)(z.photos||[]),[J]);break;case"audio":if(!$.audio){q($);break}var Z=S($.audio);z.audios=[].concat((0,i.default)(z.audios||[]),[Z]);break;case"video":if(!$.video){q($);break}var Y=A($.video,n);if(!Y){q($);break}z.videos=[].concat((0,i.default)(z.videos||[]),[Y]);break;case"doc":if(!$.doc){q($);break}var X=C($.doc);if(!X){q($);break}z.docs=[].concat((0,i.default)(z.docs||[]),[X]);break;case"link":if(!$.link){q($);break}var Q=k($.link);if(!Q){q($);break}if(s.isChatInviteLink(Q.url)&&Q.image){z.inviteLink=function(e){return e.image?h(h({},e),{},{image:e.image,kind:"InviteLink"}):void 0}(Q);break}z.link=Q;break;case"market":if(!$.market){q($);break}z.market={kind:"Market",id:(H=$.market).id,ownerId:H.owner_id,title:H.title,price:H.price.text,priceOld:H.price.old_amount_text,photo:H.thumb_photo};break;case"market_album":if(!$.market_market_album){q($);break}z.marketAlbum={kind:"MarketAlbum"};break;case"gift":if(!$.gift){q($);break}var ee=x($.gift);if(!ee){q($);break}z.gift=ee;break;case"sticker":if(!$.sticker){q($);break}var te=(0,f.fromApiSticker)($.sticker);if(!te){q($);break}z.sticker=te;break;case"wall":if(!$.wall||!$.wall.from_id||!$.wall.id){q($);break}$.wall.geo&&($.wall.attachments=[].concat((0,i.default)($.wall.attachments||[]),[{type:"geo",geo:$.wall.geo}]));var ne=K($.wall);if(!ne){q($);break}z.wall={kind:"Wall",authorId:c.resolveId($.wall.from_id),ownerId:c.resolveId(ne),id:$.wall.id,date:1e3*($.wall.date||0),chunks:u.fromServerText($.wall.text||""),attaches:_($.wall)};break;case"wall_reply":if(!($.wall_reply&&$.wall_reply.from_id&&$.wall_reply.id&&$.wall_reply.post_id)){q($);break}var re=K($.wall_reply);if(!re){q($);break}z.wallReply={kind:"WallReply",id:$.wall_reply.id,postId:$.wall_reply.post_id,authorId:c.resolveId($.wall_reply.from_id),ownerId:c.resolveId(re),parentsStack:$.wall_reply.parents_stack,date:1e3*($.wall_reply.date||0),chunks:u.fromServerText($.wall_reply.text||""),attaches:w($.wall_reply.attachments||[])};break;case"article":if(!$.article){q($);break}z.article=I($.article);break;case"poll":if(!$.poll){q($);break}z.poll=U($.poll);break;case"graffiti":if(!$.graffiti){q($);break}z.graffiti={kind:"Graffiti",imageUrl:$.graffiti.url,width:$.graffiti.width,height:$.graffiti.height};break;case"audio_message":if(!$.audio_message){q($);break}z.voice=M($.audio_message,t);break;case"audio_playlist":if(!$.audio_playlist){q($);break}z.audioPlaylist={kind:"AudioPlaylist",id:(V=$.audio_playlist).id,ownerId:V.owner_id,type:N[V.type],title:V.title,accessKey:V.access_key,image:P(V.photo,"photo")};break;case"podcast":if(!$.podcast){q($);break}z.podcast=(b=$.podcast,O=void 0,j=void 0,{kind:"Podcast",id:b.id,ownerId:b.owner_id,title:b.title,image:null!==(O=b.podcast_info)&&void 0!==O&&null!==(j=O.cover)&&void 0!==j&&j.sizes?D(b.podcast_info.cover.sizes):void 0});break;case"money_transfer":if(!$.money_transfer){q($);break}z.moneyTransfer={kind:"MoneyTransfer",text:$.money_transfer.amount.text};break;case"money_request":if(!$.money_request){q($);break}z.moneyRequest={kind:"MoneyRequest",id:(y=$.money_request).id,toId:y.to_id,fromId:y.from_id,text:y.amount.text,initUrl:y.init_url,isUserOwner:!!y.user_is_owner,isProcessed:!!y.processed};break;case"story":if(!$.story){q($);break}z.story={kind:"Story",id:(g=$.story).id,ownerId:g.owner_id,image:g.photo&&g.photo.sizes?L(g.photo.sizes):void 0,date:void 0!==g.date?1e3*g.date:void 0,available:!g.is_expired&&0!==g.can_see};break;case"geo":if(!$.geo||!$.geo.coordinates){q($);break}z.geo={kind:"Geo",coordinates:$.geo.coordinates,place:$.geo.place};break;case"call":if(!$.call){q($);break}z.finishedCall=(l=$.call,d=void 0,v=void 0,p=void 0,{kind:"FinishedCall",initiatorId:l.initiator_id,duration:l.duration,state:T(l),participants:{list:null===(d=l.participants)||void 0===d||null===(v=d.list)||void 0===v?void 0:v.map(c.resolveId),count:(null===(p=l.participants)||void 0===p?void 0:p.count)||0,coverList:R(l)}});break;case"group_call_in_progress":if(!$.group_call_in_progress){q($);break}z.activeCall=(o=$.group_call_in_progress,a=void 0,{kind:"ActiveCall",initiatorId:o.initiator_id,joinLink:o.join_link,participants:{list:null===(a=o.participants.list)||void 0===a?void 0:a.map(c.resolveId),count:o.participants.count||0,coverList:R(o)}});break;case"mini_app":if(!$.mini_app){q($);break}var oe=B($.mini_app);if(!oe){q($);break}z.miniApps=[].concat((0,i.default)(z.miniApps||[]),[oe]);break;case"donut_link":if(!$.donut_link){q($);break}var ae=F($.donut_link);if(!ae){q($);break}z.donutLink=ae;break;case"video_message":if(!$.video_message){q($);break}z.videoMessage=G($.video_message);break;case"narrative":case"artist":case"event":case"curator":case"group":case"widget":case"link_curator":case"video_playlist":q($);break;default:$.type;q($)}}}catch(e){W.e(e)}finally{W.f()}return z}function b(e){var t,n={},r=m(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;switch(o.attachment.type){case"photo":if(!o.attachment.photo)break;var a=E(o.attachment.photo,o.attachment.photo.access_key);if(!a)break;var i={attach:a,cmid:l.resolveCmid(o.message_id),messageId:l.resolveId(o.message_id),peerId:c.resolveId(o.from_id)};n.photos=(n.photos||[]).concat(i);break;case"audio":if(!o.attachment.audio)break;var s={attach:S(o.attachment.audio),cmid:l.resolveCmid(o.message_id),messageId:l.resolveId(o.message_id),peerId:c.resolveId(o.from_id)};n.audios=(n.audios||[]).concat(s);break;case"video":if(!o.attachment.video)break;var u=A(o.attachment.video,o.attachment.video.access_key);if(!u)break;var f={attach:u,cmid:l.resolveCmid(o.message_id),messageId:l.resolveId(o.message_id),peerId:c.resolveId(o.from_id)};n.videos=(n.videos||[]).concat(f);break;case"doc":if(!o.attachment.doc)break;var v=C(o.attachment.doc);if(!v)break;var p={attach:v,cmid:l.resolveCmid(o.message_id),messageId:l.resolveId(o.message_id),peerId:c.resolveId(o.from_id)};n.docs=(n.docs||[]).concat(p);break;case"link":if(!o.attachment.link)break;var h=k(o.attachment.link);if(!h)break;var g={attach:h,cmid:l.resolveCmid(o.message_id),messageId:l.resolveId(o.message_id),peerId:c.resolveId(o.from_id)};n.links=(n.links||[]).concat(g);break;case"audio_message":case"graffiti":case"market":case"share":case"wall":break;default:(0,d.exhaustivenessCheck)(o.attachment.type)}}}catch(e){r.e(e)}finally{r.f()}return n}function _(e){var t=e.geo,n=e.attachments,r=e.copy_history,o=e.access_key,i=[];t&&(null==n||n.push({type:"geo",geo:t}));var s,l=m(n||[]);try{for(l.s();!(s=l.n()).done;){var u=s.value;switch(u.type){case"photo":case"audio":case"video":case"doc":case"link":case"mini_app":case"sticker":case"market":case"article":case"poll":case"audio_playlist":case"podcast":case"market_album":case"donut_link":case"graffiti":i.push((0,a.default)({type:u.type},u.type,u[u.type]));break;case"geo":var d,f,v;if(!u.geo)break;var p=null===(d=u.geo.coordinates)||void 0===d?void 0:d.split(" ").map((function(e){return parseFloat(e)}));i.push({type:"geo",geo:h(h({},u.geo),{},{place:{title:null===(f=u.geo.place)||void 0===f?void 0:f.title,address:null===(v=u.geo.place)||void 0===v?void 0:v.address},coordinates:p&&p[0]&&p[1]?{latitude:p[0],longitude:p[1]}:void 0})});break;case"textlive":case"textpost":case"textpost_publish":case"posted_photo":case"note":case"app":case"page":case"album":case"event":case"situational_theme":case"group":case"artist":case"curator":case"photos_list":case"pretty_cards":case"narrative":break;default:u.type}}}catch(e){l.e(e)}finally{l.f()}var g=y(i,!1,o);if(null!=r&&r[0]){var b=K(r[0]);g.wallHistory={kind:"WallHistory",id:r[0].id||0,authorId:c.resolveId(r[0].from_id),ownerId:c.resolveId(b),date:1e3*(r[0].date||0),text:r[0].text||""}}return g}function w(e){var t,n=[],r=m(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;switch(o.type){case"photo":case"audio":case"video":case"doc":case"link":case"sticker":case"market":case"graffiti":n.push((0,a.default)({type:o.type},o.type,o[o.type]));break;case"market_market_album":n.push((0,a.default)({type:"market_album"},o.type,o[o.type]));break;case"note":case"page":break;default:o.type}}}catch(e){r.e(e)}finally{r.f()}return y(n,!1)}function k(e){if(e.title&&e.caption){var t=e.url,n=/^https:\/\/m\.vk\.com(.+)/;if(n.test(e.url)){var r=e.url.match(n);t=r&&r[1]?r[1]:t}return{kind:"Link",url:t,title:e.title,meta:e.caption,image:e.photo?L(e.photo.sizes||[]):void 0}}}function C(e){var t,n,r;if(e.url){var o=!(null===(t=e.preview)||void 0===t||null===(n=t.photo)||void 0===n||null===(r=n.sizes)||void 0===r||!r.length)&&L(e.preview.photo.sizes.map((function(e){return h(h({},e),{},{url:e.src})})));return h({kind:"Doc",id:e.id,ownerId:e.owner_id,title:e.title,size:e.size,ext:e.ext,date:e.date,url:e.url},o&&{image:o})}}function E(e,t){var n;if(e.sizes)return{kind:"Photo",accessKey:e.access_key,albumId:e.album_id,id:e.id,ownerId:e.owner_id,hasTags:e.has_tags,sizes:L(e.sizes),originalImage:null===(n=e.orig_photo)||void 0===n?void 0:n.url,messageAccessKey:t}}function A(e,t){if(e.id&&e.owner_id){var n=D(e.image||[{url:"",height:0,width:0}]);if(n)return{kind:"Video",accessKey:e.access_key,id:e.id,ownerId:e.owner_id,duration:e.duration,width:e.width,height:e.height,image:n,title:e.title,views:e.views||0,restriction:e.restriction,files:"files"in e?e.files:void 0,messageAccessKey:t,player:e.player,platform:e.platform}}}function I(e){var t;switch(e.state){case"available":case"banned":case"deleted":case"paid":case"protected":t=e.state;break;case void 0:t="unknown";break;default:e.state;t="unknown"}return{kind:"Article",state:t,url:e.url||"",title:e.title||"",author:e.owner_name||"",meta:e.subtitle||"",image:e.photo?L(e.photo.sizes||[]):void 0}}var O={thumb:[48,96,256,512],photo:[34,68,135,270,300,600,1200],unknown:[]};function P(e,t){if(e){var n=O[t].reduce((function(n,r){var o=e["".concat(t,"_").concat(r)];return o?(n.push({url:o,width:r,height:r}),n):n}),[]),r=(0,o.default)(n),a=r[0],s=r.slice(1);return a?[a].concat((0,i.default)(s)):void 0}}function x(e){var t=P(e,"thumb");if(t)return{kind:"Gift",id:e.id,isStickerStyle:!!e.is_stickers_style,image:t}}function S(e){return{kind:"Audio",id:e.id,ownerId:e.owner_id,artist:e.artist,title:e.title,subtitle:e.subtitle,url:e.url,duration:e.duration,albumId:e.album_id,trackCode:e.track_code,contentRestricted:e.content_restricted,albumPartNumber:e.album_part_number,accessKey:e.access_key}}function M(e,t){return{kind:"Voice",duration:e.duration,id:e.id,linkMp3:e.link_mp3,linkOgg:e.link_ogg,ownerId:e.owner_id,waveform:e.waveform,isListened:t,isTranscriptPossible:e.duration/60/60<1,transcription:j(e)}}function j(e){switch(e.transcript_state){case"done":var t;return{state:"done",text:null===(t=e.transcript)||void 0===t?void 0:t.trim(),updatedAt:e.transcript_update_time?1e3*e.transcript_update_time:void 0};case"error":case"in_progress":return{state:e.transcript_state};case void 0:return;default:(0,d.exhaustivenessCheck)(e.transcript_state)}}var N={0:"playlist",1:"album",2:"playlist",3:"playlist",4:"playlist",5:"playlist"};function L(e){return e.sort((function(e,t){return e.width-t.width})).reduce((function(e,t){var n=t.type,o=(t.src,(0,r.default)(t,v));return"s"!==n&&"m"!==n&&"x"!==n&&"o"!==n&&"p"!==n&&"q"!==n&&"r"!==n&&"y"!==n&&"z"!==n&&"w"!==n||(o.width&&o.height?e.set(n,o):e.set(n,h(h({},o),{},{width:200,height:200}))),e}),new Map)}function D(e){var t=e.sort((function(e,t){return e.width-t.width})).map((function(e){return{width:e.width,height:e.height,url:e.url}})),n=(0,o.default)(t),r=n[0],a=n.slice(1);if(r)return[r].concat((0,i.default)(a))}function R(e){var t,n=null===(t=e.participants)||void 0===t?void 0:t.list;return n?n.reduce((function(e,t){var n=c.resolveAnyId(t);return(c.isUserPeerId(n)||c.isGroupPeerId(n))&&e.push(n),e}),[]).slice(0,3):[]}function T(e){switch(e.state){case"reached":return"reached";case"canceled_by_initiator":return"canceledByInitiator";case"canceled_by_receiver":return"canceledByReceiver";default:(0,d.exhaustivenessCheck)(e.state)}}function B(e){if(e.app&&e.app.share_url&&e.app.webview_url){var t=(0,d.toNonEmpty)(e.images.map((function(e){var t=e.url,n=e.height;return{width:e.width,height:n,url:t}})));if(t){t.sort((function(e,t){return e.width-t.width}));var n=e.app.share_url.replace(/https:\/\/[a-z0-9_\-.]+\//,"");return{kind:"MiniApp",title:e.title,appLink:n,images:t,id:s.resolveMiniAppId(e.app.id),url:e.app.webview_url}}}}function F(e){var t,n,r=c.resolveId(e.owner_id);if(c.isGroupPeerId(r)&&null!==(t=e.action)&&void 0!==t&&t.url&&null!==(n=e.button.action)&&void 0!==n&&n.url&&e.button.title)return{kind:"DonutLink",ownerId:r,button:{action:{target:"internal",type:"open_url",url:e.button.action.url},title:e.button.title},donorsCount:e.donors.count,text:e.text,action:{target:"internal",type:"open_url",url:e.action.url}}}function U(e){var t,n;return{kind:"Poll",id:e.id,ownerId:c.resolveId(e.owner_id),authorId:void 0!==e.author_id?c.resolveId(e.author_id):c.resolveId(e.owner_id),title:e.question,anonymous:!!e.anonymous,endDate:1e3*e.end_date,answers:e.answers.map((function(t){var n;return{id:t.id,text:t.text,votes:t.votes,rate:t.rate,selected:!(null===(n=e.answer_ids)||void 0===n||!n.includes(t.id))}})),voted:!(null===(t=e.answer_ids)||void 0===t||!t.length),canVote:e.can_vote,canChangeVote:!e.disable_unvote,multiple:e.multiple,votes:e.votes,friends:(null===(n=e.friends)||void 0===n?void 0:n.map((function(e){return c.resolveId(e.id)})))||[],backgroundGradient:V(e.background),backgroundPhoto:H(e.photo)}}function V(e){if(e&&"gradient"===e.type){var t=e.points,n=e.angle;if(void 0!==t&&void 0!==n)return{points:t.map((function(e){return"#"+e.color})),angle:n}}}function H(e){if(e&&e.color&&e.images){var t=(0,d.toNonEmpty)(e.images.map((function(e){return{url:e.url,width:e.width,height:e.height}})));if(t)return{kind:"PollBackgroundPhoto",image:t,color:"#"+e.color}}}function K(e){var t,n=e.owner_id,r=e.source_id,o=e.to_id;return null!==(t=null!=n?n:r)&&void 0!==t?t:o}function G(e){if(e.id&&e.owner_id){var t=D(e.image||[{url:"",height:0,width:0}]);if(t)return{kind:"VideoMessage",id:e.id,ownerId:e.owner_id,duration:e.duration,shapePath:e.shape_path,image:t,files:e.files}}}},83906:(e,t,n)=>{"use strict";n.d(t,{fromApiKeyboard:()=>u,fromEngineKeyboard:()=>d,convertButtons:()=>v,fromApiMessageEvent:()=>h});var r=n(22559),o=n(33788),a=n(73974),i=n(14432),s=n(90831);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){var n=f(e.buttons,e.inline),r=i.resolveId(e.author_id||t);return e.inline?{kind:"InlineKeyboard",authorId:r,buttons:n}:{kind:"InputKeyboard",authorId:r,buttons:n,oneTime:e.one_time}}function d(e,t){return e.inline?e.buttons?{kind:"InlineKeyboard",buttons:f(e.buttons,e.inline),authorId:i.resolveId(e.author_id||t)}:void 0:null!==(n=e.buttons)&&void 0!==n&&n.length?{kind:"InputKeyboardUpsertEvent",keyboard:{kind:"InputKeyboard",buttons:f(e.buttons,e.inline),authorId:i.resolveId(e.author_id||t),oneTime:e.one_time}}:{kind:"InputKeyboardDeleteEvent"};var n}function f(e,t){return e.map((function(e){return v(e,t)}))}function v(e,t){return e.map((function(e){return function(e,t){var n,r="positive"===(n=e.color)?"commerce":"negative"===n?"destructive":"primary"===n?n:"secondary";switch(e.action.type){case"text":case"callback":return{type:e.action.type,label:(0,o.decodeHTMLEntities)(e.action.label||""),payload:e.action.payload||"",color:r};case"open_link":return{type:e.action.type,link:e.action.link,label:(0,o.decodeHTMLEntities)(e.action.label||""),payload:e.action.payload||"",color:r};case"location":return{type:e.action.type,payload:e.action.payload||"",color:r};case"vkpay":return{type:e.action.type,payload:e.action.payload||"",hash:e.action.hash||"",url:a.createAppUrl(s.VK_PAY_APP_ID,e.action.hash||"")};case"open_app":return{type:e.action.type,payload:e.action.payload||"",label:(0,o.decodeHTMLEntities)(e.action.label||""),hash:e.action.hash||"",appId:e.action.app_id||0,ownerId:e.action.owner_id||0,color:r,url:a.createAppUrl(e.action.app_id,e.action.hash||"",e.action.owner_id)};case"open_photo":return;default:return void e.action}}(e)})).filter(p)}function p(e){return void 0!==e}var h=function(e,t,n){var r=n.event_id,o=n.action,s=n.owner_id,c=a.resolveId(r),u=i.resolveId(s);if(o)switch(o.type){case"show_snackbar":return l(l({},o),{},{id:c,ownerId:u,title:i.name(e),photo:t.photo50,peerId:e.id});case"open_link":return l(l({},o),{},{id:c,ownerId:u,title:i.name(e),peerId:e.id});default:return{id:c,type:o.type,ownerId:u,url:(0,a.createAppUrl)(o.app_id,o.hash,u),peerId:e.id}}}},19117:(e,t,n)=>{"use strict";n.d(t,{fromApiChannel:()=>i});var r=n(16352),o=n(30966),a=n(92954),i=function(e,t){var n,i,s,c,l=e.channel,u=e.last_message,d=u&&(0,a.fromApiPost)(u).post,f=[];d&&(f=d.cmid>1?[{kind:"GapItem",fromCmid:o.resolveCmid(1),toCmid:o.resolveCmid(d.cmid-1)},{kind:"PostItem",post:d}]:[{kind:"PostItem",post:d}]);var v=!l.user_data.notification_settings.is_enabled||(l.user_data.notification_settings.disable_duration||0)>0;return{kind:"Channel",id:r.resolveId(l.channel_id),unreadCount:(null===(n=l.user_data.read_state)||void 0===n?void 0:n.unread_count)||0,isArchived:(null===(i=l.user_data)||void 0===i?void 0:i.is_archived)||!1,isMuted:v,notificationsDisabledUntil:l.user_data.notification_settings.disable_duration||0,inReadCmid:o.resolveCmid((null===(s=l.user_data)||void 0===s||null===(c=s.read_state)||void 0===c?void 0:c.read_up_to_cmid)||0),majorSortId:l.sort_id.major_id,minorSortId:l.sort_id.minor_id,membersCount:t.members_count||0,isMember:Boolean(t.is_member),photos:{photo50:t.photo_50,photo100:t.photo_100},name:t.name||"",activity:t.activity||"",isVerified:Boolean(t.verified),screenName:t.screen_name,history:f,pending:{},locks:{loading:!1,cleanUp:0}}}},89032:(e,t,n)=>{"use strict";n.d(t,{fromApiConvo:()=>p,fromLongpollPushSettings:()=>h});var r=n(80312),o=n(22559),a=n(14432),i=n(60202),s=n(80662),c=n(96543),l=n(83906),u=n(41450);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={18:"peer_deleted",900:"peer_blacklisted",901:"peer_blacklisted",902:"peer_blacklisted",915:"disabled_by_community",916:"disabled_by_peer",917:"kicked",918:"no_access",925:"no_access",932:"no_access",945:"chat_unsupported",946:"chat_unsupported",203:"disabled_by_peer"};function p(e,t){var n,o,d,v=t&&(0,c.fromApiMessage)(t).message,p=e.current_keyboard&&(0,l.fromApiKeyboard)(e.current_keyboard);if("InlineKeyboard"===(null==p?void 0:p.kind))throw new Error("Не может прийти инлайн клавиатура для сообщения");var h,b,_,w,k,C={majorSortId:(null===(n=e.sort_id)||void 0===n?void 0:n.major_id)||0,minorSortId:(null===(o=e.sort_id)||void 0===o?void 0:o.minor_id)||0,unreadCount:e.unread_count||0,isMarkedUnread:!!e.is_marked_unread,isArchived:!!e.is_archived,inReadBy:s.resolveCmid(e.in_read_cmid),outReadBy:s.resolveCmid(e.out_read_cmid),folderIds:new Set((null===(d=e.folder_ids)||void 0===d?void 0:d.map(i.resolveId))||[]),isNew:!!e.is_new,canWrite:g(e),currentKeyboard:p,push:m(e.push_settings),persistedCmid:s.resolveCmid(null==v?void 0:v.cmid),persisted:v?new Map([[v.cmid,f(f({},v),{},{olderId:s.resolveCmid(),newerId:s.resolveCmid()})]]):new Map,queuedId:s.resolveRandomId(),queued:new Map,unreadExpireables:new Set((e.expire_cmids||[]).map(s.resolveCmid)),hasMore:e.last_message_id>0,convoBanner:e.conversation_bar&&(h=e.conversation_bar,{icon:null!==(b=h.icon)&&void 0!==b?b:"",name:h.name,title:null!==(_=h.title)&&void 0!==_?_:"",chunks:u.fromServerText(h.text),canHide:h.can_hide||!0,buttons:(h.buttons||[]).map((function(e){var t,n,r;return{callbackData:null!==(t=null==e?void 0:e.callback_data)&&void 0!==t?t:"",mode:null!==(n=null==e?void 0:e.style)&&void 0!==n?n:e.layout,link:null!==(r=null==e?void 0:e.link)&&void 0!==r?r:"",text:e.text,hideOnAction:!!e.hide_on_action,type:e.type}}))})},E=a.resolveId(e.peer.id);switch(e.peer.type){case"user":if(!a.isUserPeerId(E))return null;if(void 0!==e.message_request_data){var A=e.message_request_data.status;return"pending"===A?{convo:f(f({},C),{},{kind:"MessageRequestUserConvo",peerId:E,MRStatus:A})}:null}return{convo:f(f({},C),{},{kind:"UserConvo",peerId:E})};case"chat":var I,O,P,x,S,M,j,N;if(!a.isChatPeerId(E))return null;if(!e.chat_settings)throw new Error("TODO chat convo has to has chat settings");var L=e.chat_settings.owner_id&&0!==e.chat_settings.owner_id?a.resolveId(e.chat_settings.owner_id):void 0,D=L&&(a.isUserPeerId(L)||a.isGroupPeerId(L))?L:void 0,R=f(f({},C),{},{peerId:E,ownerId:D,unreadMentions:new Set((e.mention_cmids||[]).map(s.resolveCmid)),membersCount:(null===(I=e.chat_settings)||void 0===I?void 0:I.members_count)||0,state:null===(O=e.chat_settings)||void 0===O?void 0:O.state,isCasper:!!e.chat_settings.is_disappearing,isCommunityChat:!!L&&a.isGroupPeerId(L),isDonut:!!e.chat_settings.is_donut,activeCall:y(e.call_in_progress),pinnedMessage:e.chat_settings.pinned_message?(0,c.fromApiPinnedMessage)(e.chat_settings.pinned_message):void 0,acl:(k=e.chat_settings.acl,{canChangeInfo:k.can_change_info,canChangeInviteLink:k.can_change_invite_link,canChangePin:k.can_change_pin,canInvite:k.can_invite,canPromoteUsers:k.can_promote_users,canSeeInviteLink:k.can_see_invite_link,canModerate:k.can_moderate,canCopyChat:k.can_copy_chat,canCall:k.can_call,canUseMassMentions:k.can_use_mass_mentions,canChangeServiceType:Boolean(k.can_change_service_type),canChangeStyle:Boolean(k.can_change_style)}),permissions:e.chat_settings.permissions?(w=e.chat_settings.permissions,{invite:w.invite||"all",change_info:w.change_info||"all",change_pin:w.change_pin||"all",use_mass_mentions:w.use_mass_mentions||"all",see_invite_link:w.see_invite_link||"all",call:w.call||"all",change_style:w.change_style||"all",change_admins:w.change_admins||"owner"}):void 0,isService:Boolean(e.chat_settings.is_service),adminIds:new Set([].concat((0,r.default)([L]||0),(0,r.default)(e.chat_settings.admin_ids||[])).map(a.resolveId)),memberIds:new Set([]),invitedIds:new Set([])}),T={kind:"Chat",id:E,title:(null===(P=e.chat_settings)||void 0===P?void 0:P.title)||"",photo50:null===(x=e.chat_settings.photo)||void 0===x?void 0:x.photo_50,photo100:null===(S=e.chat_settings.photo)||void 0===S?void 0:S.photo_100,photo200:null===(M=e.chat_settings.photo)||void 0===M?void 0:M.photo_200,hasDefaultPhoto:(null===(j=e.chat_settings.photo)||void 0===j?void 0:j.is_default_photo)||(null===(N=e.chat_settings.photo)||void 0===N?void 0:N.is_default_call_photo),canCall:e.chat_settings.acl.can_call};if(void 0!==e.message_request_data){var B=e.message_request_data,F=B.status,U=B.inviter_id;return"pending"===F&&void 0!==U?{convo:f(f({},R),{},{kind:"MessageRequestChatConvo",inviterPeerId:a.resolveId(U),MRStatus:F}),peer:T}:null}return{convo:f(f({},R),{},{kind:"ChatConvo"}),peer:T};case"group":return a.isGroupPeerId(E)?{convo:f(f({},C),{},{peerId:E,kind:"GroupConvo"})}:null;case"email":return null;case"contact":return a.isContactPeerId(E)?{convo:f(f({},C),{},{peerId:E,kind:"ContactConvo"})}:null;default:e.peer.type;return null}}function h(e){var t=Number(e[1].disabled_until);switch(t){case 0:return{mode:"everything",disabledUntil:0};case-1:return{mode:"every-mention",disabledUntil:1/0};default:return{mode:"every-mention",disabledUntil:1e3*t}}}function m(e){var t={mode:"everything",disabledUntil:0};return e?(e.disabled_forever?t={mode:"every-mention",disabledUntil:1/0}:e.disabled_until&&(t={mode:"every-mention",disabledUntil:1e3*e.disabled_until}),"everything"!==t.mode&&(e.disabled_mass_mentions&&(t=f(f({},t),{},{mode:"direct-mention"})),e.disabled_mentions&&(t=f(f({},t),{},{mode:"nothing"}))),t):t}function g(e){var t,n=e.can_write;return"chat"===e.peer.type&&"rejected"===(null===(t=e.message_request_data)||void 0===t?void 0:t.status)?{allowed:!1,reason:"mr_rejected"}:null!=n&&n.allowed?{allowed:!0}:{allowed:!1,reason:(null==n?void 0:n.reason)&&v[n.reason]||"unknown"}}function y(e){if(e)return{participants:{list:(e.participants.list||[]).reduce((function(e,t){var n=a.resolveAnyId(t);return(a.isUserPeerId(n)||a.isGroupPeerId(n))&&e.push(n),e}),[]),count:e.participants.count||0},joinLink:e.join_link,canFinishCall:Boolean(e.can_finish_call),hasLink:Boolean(e.has_link)}}},90917:(e,t,n)=>{"use strict";n.d(t,{fromApiFolder:()=>o});var r=n(60202);function o(e){return{id:r.resolveId(e.id),name:e.name,unreadCount:0,unreadUnmutedCount:0,all:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0},unread:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0}}}},96543:(e,t,n)=>{"use strict";n.d(t,{fromApiMessage:()=>_,fromApiPinnedMessage:()=>I,fromEngineMessage:()=>w});var r=n(80312),o=n(56568),a=n(81385),i=n(3460),s=n(80662),c=n(14432),l=n(41450),u=n(21705),d=n(83906),f=n(22559),v=n(16790),p=["buttons","photo","action"];function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,f.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){var n;return{kind:"carousel",elements:(null===(n=e.elements)||void 0===n?void 0:n.map((function(e){return function(e,t){var n=e.buttons,r=e.photo,o=e.action,a=(0,v.default)(e,p),s=r?(0,i.fromApiPhoto)(r,t):null,c=m(m({buttons:n?(0,d.convertButtons)(n,!0):[]},s&&{photo:s}),a),l=m(m({},c),{},{kind:"simple"});if(!o)return l;switch(o.type){case"open_photo":return r&&s?m(m({},c),{},{kind:"photo",photo:s}):l;case"open_link":return m(m({},c),{},{kind:"link",link:o.link});default:return l}}(e,t)})))||[]}}function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e){if(e.action)return{message:{kind:"Service",id:s.resolveId(e.id),action:E({apiAction:e.action,apiAttaches:e.attachments}),peerId:c.resolveId(e.peer_id),cmid:s.resolveCmid(e.conversation_message_id),authorId:c.resolveId(e.from_id),sentAt:1e3*e.date,isOut:1===e.out,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0},mentions:{hasDirect:!1,hasMass:!1}};var t=c.resolveId(e.peer_id);if(e.is_expired)return{message:{kind:"Expired",id:s.resolveId(e.id),cmid:s.resolveCmid(e.conversation_message_id),peerId:c.resolveId(e.peer_id),authorId:c.resolveId(e.from_id),isOut:1===e.out,sentAt:1e3*e.date},mentions:{hasDirect:!1,hasMass:!1}};var n=e.keyboard&&(0,d.fromApiKeyboard)(e.keyboard);if("InputKeyboard"===(null==n?void 0:n.kind))throw new Error("Кажется из апи пришла не инлайн клавиатура для сообщения");var r=s.resolveCmid(e.conversation_message_id);return{message:{kind:"Normal",id:s.resolveId(e.id),randomId:s.resolveRandomId(e.random_id),cmid:r,peerId:t,authorId:c.resolveId(e.from_id),chunks:l.fromServerText(e.text),isOut:1===e.out,isImportant:!!e.important,sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,i.fromApiAttach)(A(e),!!e.was_listened,"mail".concat(e.id)),keyboard:n,forwardedMessages:C(e.fwd_messages,t,r),replyMessage:e.reply_message?k(e.reply_message,t,r):void 0,expireTTL:e.expire_ttl?1e3*e.expire_ttl:void 0,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0,template:e.template?g(e.template,"mail".concat(e.id)):void 0},mentions:{hasDirect:!1,hasMass:!1}}}function w(e,t,n){var r,f,v,p,h,m,g,b,_,w;switch(e[0]){case 4:var k=(0,o.default)(e,11);r=k[1],f=k[2],v=k[4],p=k[5],h=k[6],m=k[7],g=k[8],b=k[9],w=k[10];break;case 10004:var C=(0,o.default)(e,11);w=C[1],f=C[2],v=C[4],p=C[5],h=C[6],m=C[7],g=C[8],b=C[9],r=C[10];break;case 5:var A=(0,o.default)(e,11);r=A[1],f=A[2],v=A[3],p=A[4],h=A[5],m=A[6],g=A[7],b=A[8],w=A[9],_=A[10];break;case 10005:var I=(0,o.default)(e,11);w=I[1],f=I[2],v=I[3],p=I[4],h=I[5],m=I[6],g=I[7],b=I[8],r=I[9],_=I[10];break;case 18:var O=(0,o.default)(e,11);r=O[1],f=O[2],v=O[3],p=O[4],h=O[5],m=O[6],g=O[7],b=O[8],w=O[9],_=O[10];break;case 10018:var P=(0,o.default)(e,11);w=P[1],f=P[2],v=P[3],p=P[4],h=P[5],m=P[6],g=P[7],b=P[8],r=P[9],_=P[10];break;default:(0,u.exhaustivenessCheck)(e)}var x,S=c.resolveId(v),M=s.convertFlags(f),j=M.isOut,N=M.isImportant,L=M.noPush,D=M.isVoiceListened,R=j||S===t;if(x=void 0!==m.from?c.resolveId(Number(m.from)):R?t:S,m.source_act)return{message:{kind:"Service",id:s.resolveId(r),cmid:s.resolveCmid(w),peerId:S,authorId:x,action:E({apiAction:{conversation_message_id:m.source_chat_local_id?Number(m.source_chat_local_id):void 0,message:m.source_message,type:m.source_act,member_id:m.source_mid?Number(m.source_mid):void 0,text:m.source_text,old_text:m.source_old_text,style:m.source_style}}),deleteTTL:void 0!==m.ttl?1e3*Number(m.ttl):void 0,sentAt:1e3*p,isOut:R},mentions:{hasDirect:!1,hasMass:!1},noPush:L};if("1"===m.is_expired)return{message:{kind:"Expired",id:s.resolveId(r),cmid:s.resolveCmid(w),isOut:R,peerId:S,authorId:x,sentAt:1e3*p},mentions:{hasDirect:!1,hasMass:!1},noPush:!0};var T,B={hasDirect:!1,hasMass:!1},F=y(m.marked_users||[]);try{for(F.s();!(T=F.n()).done;){var U=T.value;if(U[0]===a.IEngine.MarkedType.Mention)switch(U[1]){case"all":B.hasMass=B.hasMass||x!==t;break;case"online":B.hasMass=B.hasMass||U[2].includes(t);break;default:B.hasDirect=U[1].includes(t)}}}catch(e){F.e(e)}finally{F.f()}var V,H={};if("sticker"!==g.attach1_type&&"audiomsg"!==g.attach1_kind||!g.attachments)void 0!==g.attach1_type&&(H={unknown:[{data:g,kind:"Unknown"}]});else{var K=JSON.parse(g.attachments);Array.isArray(K)&&(H=(0,i.fromApiAttach)(K,D,"mail".concat(r)))}if(void 0!==g.reply){var G=JSON.parse(g.reply),z=n(s.resolveCmid(G.conversation_message_id));z&&(V=s.toForeign({message:z,rootPeerId:S,rootCmid:s.resolveCmid(w)}))}var q,W,$=m.keyboard?(0,d.fromEngineKeyboard)(m.keyboard,x):void 0;return"InlineKeyboard"===(null==$?void 0:$.kind)?q=$:W=$,{message:{kind:"Normal",id:s.resolveId(r),cmid:s.resolveCmid(w),randomId:s.resolveRandomId(b),peerId:S,authorId:x,chunks:l.fromServerText(h),isOut:R,isImportant:N,sentAt:1e3*p,updatedAt:_?1e3*_:void 0,expireTTL:m.expire_ttl?1e3*Number(m.expire_ttl):void 0,deleteTTL:void 0!==m.ttl?1e3*Number(m.ttl):void 0,attaches:H,replyMessage:V,keyboard:q},mentions:B,noPush:L,keyboardEvent:W}}function k(e,t,n){var r,o;return e.peer_id&&(r=c.resolveId(e.peer_id)),e.id&&(o=s.resolveId(e.id)),{kind:"Foreign",id:o,peerId:r,rootPeerId:t,rootCmid:n,cmid:s.resolveCmid(e.conversation_message_id),authorId:c.resolveId(e.from_id),chunks:l.fromServerText(e.text),sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,i.fromApiAttach)(A(e),!!e.was_listened,e.id?"mail".concat(e.id):void 0),forwardedMessages:C(e.fwd_messages,t,n),replyMessage:e.reply_message?k(e.reply_message,t,n):void 0}}function C(e,t,n){if(e&&0!==e.length){var r,o,a=y(e);try{for(a.s();!(o=a.n()).done;){var i=o.value;r?r.push(k(i,t,n)):r=[k(i,t,n)]}}catch(e){a.e(e)}finally{a.f()}return r}}function E(e){var t=e.apiAction,n=e.apiAttaches,r={type:"unknown"};switch(t.type){case"chat_create":return t.text?{type:t.type,title:t.text}:r;case"chat_title_update":return t.text&&t.old_text?{type:t.type,title:t.text,oldTitle:t.old_text}:r;case"chat_photo_remove":case"chat_screenshot":case"chat_group_call_started":case"chat_invite_user_by_link":case"chat_invite_user_by_call_join_link":case"chat_kick_don":return{type:t.type};case"chat_pin_message":case"chat_unpin_message":return{type:t.type,cmid:s.resolveCmid(t.conversation_message_id),text:t.message};case"chat_photo_update":var o=null==n?void 0:n.find((function(e){return"photo"===e.type})),a=null==o?void 0:o.photo;if(!a)return r;var l=(0,i.fromApiPhoto)(a);return l?{type:t.type,photo:l}:r;case"chat_invite_user":case"chat_kick_user":case"accepted_message_request":if(!t.member_id)return r;var u=c.resolveId(t.member_id);return c.isUserPeerId(u)||c.isGroupPeerId(u)?{type:t.type,peerId:u}:r;case"chat_invite_user_by_message_request":case"chat_invite_user_by_call":case"chat_kick_user_call_block":if(!t.member_id)return r;var d=c.resolveId(t.member_id);return c.isUserPeerId(d)?{type:t.type,peerId:d}:r;case"conversation_style_update":case"conversation_style_update_action":return{type:t.type,style:t.style};case"custom":return r;default:t.type;return r}}function A(e){var t=e.attachments,n=void 0===t?[]:t,o=e.geo;return o?[].concat((0,r.default)(n),[{type:"geo",geo:o}]):n}function I(e){var t,n=c.resolveId(e.peer_id),r=s.resolveCmid(e.conversation_message_id),o=c.resolveId(e.from_id);return e.id&&(t=s.resolveId(e.id)),{kind:"Pinned",id:t,cmid:r,peerId:n,authorId:o,chunks:l.fromServerText(e.text),sentAt:1e3*e.date,forwardedMessages:e.fwd_messages?C(e.fwd_messages,n,r):void 0,replyMessage:e.reply_message?k(e.reply_message,n,r):void 0,attaches:(0,i.fromApiAttach)(e.attachments||[],!1)}}},4850:(e,t,n)=>{"use strict";n.d(t,{fromApiUser:()=>i,fromApiGroup:()=>s,fromApiContact:()=>c,fromApiAnonym:()=>l,convertPlatform:()=>u});var r=n(14432),o=[6482950,6481715,6146827],a={1:"mobile",2:"mobile",3:"mobile",4:"mobile",5:"mobile",6:"other",7:"other"};function i(e){var t,n,a,i,s,c,l={0:"unfamiliar",1:"outgoingRequest",2:"incomingRequest",3:"friends"},u="other";null!==(t=e.online_info)&&void 0!==t&&t.is_mobile&&(u="mobile"),o.includes((null===(n=e.online_info)||void 0===n?void 0:n.app_id)||0)&&(u="vkme");var d=r.resolveRealId("User",e.id),f=Boolean(e.blacklisted);return{user:{kind:"User",id:d,firstName:e.first_name,firstNameGen:e.first_name_gen||e.first_name,firstNameAcc:e.first_name_acc||e.first_name,lastName:e.last_name,lastNameGen:e.last_name_gen||e.last_name,lastNameAcc:e.last_name_acc||e.last_name,screenName:e.screen_name,sex:void 0!==e.sex?{0:"unknown",1:"female",2:"male"}[e.sex]:"unknown",photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,lastSeen:{isVisible:!(null===(a=e.online_info)||void 0===a||!a.visible),at:(null===(i=e.online_info)||void 0===i?void 0:i.last_seen)&&1e3*e.online_info.last_seen,platform:u},isVerified:Boolean(e.verified),isBlacklisted:f,isBlacklistedByMe:Boolean(e.blacklisted_by_me),isDeactivated:Boolean(e.deactivated),canCall:Boolean(e.can_call),canChangeFriendship:1===e.can_send_friend_request,canInviteToChats:!!e.can_invite_to_chats,canMessage:1===e.can_write_private_message,followersCount:e.followers_count||0,friendship:void 0!==e.friend_status?l[e.friend_status]:l[0],mutualFriends:f?{hint:[],count:0}:void 0,contactName:e.contact_name,occupation:e.occupation,bdate:e.bdate,city:e.city},isOnline:!(null===(s=e.online_info)||void 0===s||!s.visible||null===(c=e.online_info)||void 0===c||!c.is_online)}}function s(e){var t,n=r.resolveRealId("Group",e.id);if(!e.type)throw new Error("fromApiGroup содержит некорректный тип ".concat(e.type));var o={0:"notMember",1:"member",2:"unsure",3:"declined",4:"outgoingRequest",5:"incomingRequest"}[e.member_status||0];return{kind:"Group",id:n,type:e.type,name:e.name,screenName:e.screen_name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,activity:e.activity,memberCount:e.members_count||0,membership:o,isDeactivated:Boolean(e.deactivated),isVerified:1===e.verified,isClosed:Boolean(e.is_closed),canMessage:1===e.can_message,canChangeMembership:0!==(null===(t=e.ban_info)||void 0===t?void 0:t.end_date)&&(0===e.is_closed||"member"===o||"incomingRequest"===o),mutualFriends:2===e.is_closed&&"member"!==o?{hint:[],count:0}:void 0}}function c(e){var t=r.resolveRealId("Contact",e.id),n=r.resolveId(e.user_id);return{kind:"Contact",id:t,name:e.name,userId:n,phone:e.phone,canWrite:e.can_write,photo50:e.photo_50,lastSeen:e.last_seen_status}}function l(e){var t=r.resolveAnyId(e.id);if(r.isAnonymPeerId(t))return{id:t,kind:"Anonym",name:e.name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,photo400:e.photo_400}}function u(e,t){var n=a[e]||"other";return o.includes(t)&&(n="vkme"),n}},92954:(e,t,n)=>{"use strict";n.d(t,{fromApiPost:()=>v});var r=n(22559),o=n(30966),a=n(41450),i=n(14432),s=n(16352),c=n(94170),l=n(3460);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={id:"reactions",items:[{id:0,title:"Нравится",asset:{animation_url:"https://vk.com/reaction/3-reactions-0?c_uniq_tag=83b2081a8e4adfc36ee536f5f1b4ad470174c89678369a4b9dc5547614a3955e",images:[{url:"https://vk.com/reaction/1-reactions-0-48?c_uniq_tag=e6bee176471af6e4f7ca0f57ac099847d57b8101bf07944e47b42b097a6d8455",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-0-72?c_uniq_tag=d6f55fe94c0add8f817b447cbd804768752eb996c06ef222b39eb3fd35834780",width:72,height:72}],title:{color:{foreground:{light:"FF3347",dark:"FF5C5C"},background:{light:"FFEDED",dark:"3E2526"}}},title_color:{light:"FF3347",dark:"FF5C5C"}}},{id:1,title:"Смешно",asset:{animation_url:"https://vk.com/reaction/3-reactions-1?c_uniq_tag=a47193579880c0f53dd597a15d3bd57d4827820687c73d6128df2720647b42b9",images:[{url:"https://vk.com/reaction/1-reactions-1-48?c_uniq_tag=8f5eb3a1d6a6ec81aceff211782af3c9e9a5d1c837f0bfade6965a6844786f8b",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-1-72?c_uniq_tag=c852fcad6e67059878dcf1905e3e416fd89fbc61222ead100935a6fcc1dab4c9",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:2,title:"Ого!",asset:{animation_url:"https://vk.com/reaction/3-reactions-2?c_uniq_tag=b946fcbe262642bc920331746b6eccd9f175bb17d8ef37e54d232fa35ca2c750",images:[{url:"https://vk.com/reaction/1-reactions-2-48?c_uniq_tag=2a6544dce8827d216db7ea91eafc726cd3a823f5d465ba00216901a6de2801ad",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-2-72?c_uniq_tag=5a0663f3d38dd6fbcf3e4973610d50641420631c9df30b6cf80eee0dd5c5efee",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:3,title:"Восторг",asset:{animation_url:"https://vk.com/reaction/3-reactions-3?c_uniq_tag=c6ed3add99e841dccda5479c8e21779954e61e0fba15f94a2ae16706df492123",images:[{url:"https://vk.com/reaction/1-reactions-3-48?c_uniq_tag=eda1a2c18d733b356babdeed5f52cdcc64dd59f1f69776a133fc34a5627eecee",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-3-72?c_uniq_tag=be09c5080773a9ba78984406588c7371e48073e80b842eb7c9a817f7b435379b",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:5,title:"Печаль",asset:{animation_url:"https://vk.com/reaction/3-reactions-5?c_uniq_tag=c61122c8c334154cb10ccf0e0687057bf1f0f40c2817198b2e1150df534c22c4",images:[{url:"https://vk.com/reaction/1-reactions-5-48?c_uniq_tag=31bcb230babad96120a62589c52af22811aaba54d4ed73a36cfd499d9d94102f",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-5-72?c_uniq_tag=a840d0eb581c133d97638ff5bf34f4b33f3fb8557b932cfe3516925b88e2f151",width:72,height:72}],title:{color:{foreground:{light:"4986CC",dark:"71AAEB"},background:{light:"EDF3FA",dark:"27303C"}}},title_color:{light:"4986CC",dark:"71AAEB"}}},{id:4,title:"&$#%!",asset:{animation_url:"https://vk.com/reaction/3-reactions-4?c_uniq_tag=063e6b2dd888bb5a9716cf6153f03bf9c0c9707713b857eed8fe1e4e09aea2b3",images:[{url:"https://vk.com/reaction/1-reactions-4-48?c_uniq_tag=c80e3224c299a73384c057ff065c9458dcd533d57a1458875eb98883c3a96783",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-4-72?c_uniq_tag=a0eddba1ec31f96adbb9afa2c6c14bec055b95f8d9f113bdf759fb5a9c9054f0",width:72,height:72}],title:{color:{foreground:{light:"EF5203",dark:"FA5300"},background:{light:"FDEBE8",dark:"3C2421"}}},title_color:{light:"EF5203",dark:"FA5300"}}}]};function v(e){var t,n,r,u,v,p,h,m,g,y,b,_=null==e||null===(t=e.attachments)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.wall,w=null==_||null===(r=_.copy_history)||void 0===r?void 0:r[0],k={};if(w){var C=(0,l.apiAttachWallOwnerId)(w),E="reply"===w.post_type;k=d(d({},k),E?{wallReply:{kind:"WallReply",id:w.id||0,postId:w.reply_post_id||0,authorId:i.resolveId(w.from_id),ownerId:i.resolveId(C),parentsStack:w.parents_stack,date:1e3*(w.date||0),chunks:a.fromServerText(w.text||""),attaches:(0,l.fromApiWallAttach)(w)}}:{wall:{kind:"Wall",id:w.id||0,authorId:i.resolveId(w.from_id),ownerId:i.resolveId(C),date:1e3*(w.date||0),chunks:a.fromServerText(w.text||""),attaches:(0,l.fromApiWallAttach)(w)}}),_.copy_history=void 0}null!=_&&_.attachments&&(k=d(d({},k),(0,l.fromApiWallAttach)(_)));var A=[],I=[];return f.items.forEach((function(e){var t=function(e){var t,n,r,o,a,i;if(e.asset.animation_url&&null!==(t=e.asset.title_color)&&void 0!==t&&t.dark&&null!==(n=e.asset.title_color)&&void 0!==n&&n.light){var s=null===(r=e.asset.images.find((function(e){return 48===e.height})))||void 0===r?void 0:r.url,l=null===(o=e.asset.images.find((function(e){return 72===e.height})))||void 0===o?void 0:o.url;if(s&&l)return{id:c.resolveId(e.id),animation:e.asset.animation_url,title:e.title,image48:s,image72:l,color:{light:null===(a=e.asset.title_color)||void 0===a?void 0:a.light,dark:null===(i=e.asset.title_color)||void 0===i?void 0:i.dark}}}}(e);t&&(A.push(t),I.push(t.id))})),{post:{kind:"Normal",cmid:o.resolveCmid(e.cmid),chunks:null!=_&&_.text?a.fromServerText(_.text):[],views:(null==_||null===(u=_.views)||void 0===u?void 0:u.count)||0,sentAt:1e3*e.time,updatedAt:e.update_time&&1e3*e.update_time,authorId:s.resolveId(e.author_id),likes:{count:(null==_||null===(v=_.likes)||void 0===v?void 0:v.count)||0,reactionId:Boolean(null==_||null===(p=_.likes)||void 0===p?void 0:p.user_likes)?c.resolveId(0):void 0,availableReactionIds:I},reposts:{count:(null==_||null===(h=_.reposts)||void 0===h?void 0:h.count)||0,isReposted:Boolean(null==_||null===(m=_.reposts)||void 0===m?void 0:m.user_reposted)},comments:{count:(null==_||null===(g=_.comments)||void 0===g?void 0:g.count)||0,oneLevelCount:0,canView:Boolean(null==_||null===(y=_.comments)||void 0===y?void 0:y.can_view),canPost:Boolean(null==_||null===(b=_.comments)||void 0===b?void 0:b.can_post),history:[],order:"interesting"},attaches:k},reactions:A}}},78399:(e,t,n)=>{"use strict";n.d(t,{fromApiStickerPack:()=>i,fromApiSticker:()=>s,fromApiStickersKeywords:()=>c});var r=n(78664);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){if("stickers"===e.type&&e.title&&e.previews&&e.stickers){var t=e.previews.find((function(e){return 22===e.height})),n=e.previews.find((function(e){return 34===e.height})),o=e.previews.find((function(e){return 44===e.height})),a=e.previews.find((function(e){return 68===e.height}));if(t&&n&&o&&a){var i=[],c=[];return e.stickers.reduce((function(e,t){var n=s(t);return n?(c.push(n),e.push(n.id),e):e}),i),{stickerPack:{id:r.resolveStickerPackId(e.id),name:e.title,icons:{icon22:t.url,icon34:n.url,icon44:o.url,icon68:a.url},stickerIds:i},stickers:c}}}}function s(e){var t,n;if("sticker_id"in e&&e.images&&e.images_with_background&&e.sticker_id){e.images.sort((function(e,t){return e.height-t.height}));var o=e.images.find((function(e){return e.height>=128})),a=e.images.find((function(e){return e.height>=256})),i=e.images_with_background.find((function(e){return e.height>=128})),s=e.images_with_background.find((function(e){return e.height>=256}));if(o&&a&&i&&s)return{id:r.resolveStickerId(e.sticker_id),kind:"Sticker",isAllowed:void 0===e.is_allowed||e.is_allowed,image128:{light:o.url,dark:i.url},image256:{light:a.url,dark:s.url},animation:e.animations&&{light:(null===(t=e.animations.find((function(e){return"light"===e.type})))||void 0===t?void 0:t.url)||"",dark:(null===(n=e.animations.find((function(e){return"dark"===e.type})))||void 0===n?void 0:n.url)||""}}}}function c(e){return e.dictionary.reduce((function(e,t){var n,a,i,s=null!==(n=null===(a=t.stickers)||void 0===a?void 0:a.map((function(e){var t=e.sticker_id;return r.resolveStickerId(t)})))&&void 0!==n?n:[],c=o(t.words);try{for(c.s();!(i=c.n()).done;){e[i.value]=s}}catch(e){c.e(e)}finally{c.f()}return e}),{})}},81385:(e,t,n)=>{"use strict";var r,o,a,i,s;n.d(t,{IEngine:()=>r}),o=r||(r={}),function(e){e[e.Mention=1]="Mention",e[e.ExpiringMessage=2]="ExpiringMessage"}(a||(a={})),o.MarkedType=a,function(e){e[e.CopyFlagChanged=0]="CopyFlagChanged",e[e.TitleChanged=1]="TitleChanged",e[e.AvatarChanged=2]="AvatarChanged",e[e.AdminGrated=3]="AdminGrated",e[e.FlagsChanged=4]="FlagsChanged",e[e.Pinned=5]="Pinned",e[e.UserJoined=6]="UserJoined",e[e.UserLeft=7]="UserLeft",e[e.UserKicked=8]="UserKicked",e[e.AdminKicked=9]="AdminKicked",e[e.BannerChanged=10]="BannerChanged",e[e.KeyboardChanged=11]="KeyboardChanged",e[e.MessageRequestChanged=12]="MessageRequestChanged",e[e.ContactConverted=13]="ContactConverted",e[e.BusinessNotifyDataChanged=14]="BusinessNotifyDataChanged",e[e.MessageRequestCanceled=15]="MessageRequestCanceled",e[e.MessageRequestRejected=16]="MessageRequestRejected",e[e.MessageRequestAccepted=17]="MessageRequestAccepted",e[e.ContactJoined=18]="ContactJoined",e[e.CallInProgressChanged=19]="CallInProgressChanged",e[e.DonSubscribed=20]="DonSubscribed",e[e.DonUnsubscribed=21]="DonUnsubscribed",e[e.IsNewChange=22]="IsNewChange",e[e.StyleChanged=23]="StyleChanged"}(i||(i={})),o.ChatUpdateType=i,function(e){e[e.Deleted=0]="Deleted",e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.New=3]="New"}(s||(s={})),o.MRStatus=s,o.isIncompleteUpdate=function(e){switch(e[0]){case 10004:case 4:return e.length<12;case 10005:case 10018:case 5:case 18:return e.length<11;default:return!1}}},37021:(e,t,n)=>{"use strict";n.d(t,{TypingVariants:()=>h,insertConvos:()=>m,insertPeers:()=>y,insertContacts:()=>b,insertFolders:()=>_,insertChannels:()=>w,getOwnerGroupId:()=>k,removeConvosFromFolder:()=>C,addConvosToFolder:()=>E,getConvosByIds:()=>A});var r=n(9727),o=n(14432),a=n(33600),i=n(16352),s=n(60202),c=n(89032),l=n(4850),u=n(90917),d=n(19117),f=n(92954);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=["text","voice","photo","video","file"];function m(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.dangerouslyMerge,s=[],l=v(t);try{for(l.s();!(n=l.n()).done;){var u,d=n.value,f="conversation"in d?(0,c.fromApiConvo)(d.conversation,d.last_message):(0,c.fromApiConvo)(d);if(f){var p=f.convo,h=f.peer,m=e.convos.get(p.peerId);if(!m||i){var y=g(p,m);e.convos.set(p.peerId,y),h&&e.peers.set(h.id,h),s.push(p),"ChatConvo"===y.kind&&e.hiddenPinnedMessages.get(y.peerId)!==(null===(u=y.pinnedMessage)||void 0===u?void 0:u.cmid)&&e.hiddenPinnedMessages.delete(y.peerId)}else s.push(m)}}}catch(e){l.e(e)}finally{l.f()}var b=s.filter((function(e){return!r.isMR(e)}));return a.add(e.convosSearchIndex,b,(function(t){var n=e.peers.get(t.peerId);return{id:t.peerId,strings:n?a.peerWords(n):[]}})),s}function g(e,t){return t?(0===t.persisted.size&&0===t.queued.size&&(t.persisted=e.persisted,t.persistedCmid=e.persistedCmid),t):e}function y(e,t){var n,r=t.apiUsers,o=t.apiGroups,a=t.apiContacts,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=i.dangerouslyOverwrite,c=[],u=v(r);try{for(u.s();!(n=u.n()).done;){var d=n.value,f=(0,l.fromApiUser)(d),p=f.user,h=f.isOnline,m=e.peers.get(p.id);!m||"User"!==m.kind||s?(e.peers.set(p.id,p),s&&e.onlines.delete(p.id),h&&e.onlines.add(p.id),c.push(p)):c.push(m)}}catch(e){u.e(e)}finally{u.f()}var g,y=[],b=v(o);try{for(b.s();!(g=b.n()).done;){var _=g.value,w=(0,l.fromApiGroup)(_),k=e.peers.get(w.id);!k||"Group"!==k.kind||s?(e.peers.set(w.id,w),y.push(w)):y.push(k)}}catch(e){b.e(e)}finally{b.f()}var C,E=[],A=v(a);try{for(A.s();!(C=A.n()).done;){var I=C.value,O=(0,l.fromApiContact)(I),P=e.peers.get(O.id);!P||"Contact"!==P.kind||s?(e.peers.set(O.id,O),E.push(O)):E.push(P)}}catch(e){A.e(e)}finally{A.f()}return{insertedUsers:c,insertedGroups:y,insertedContacts:E}}function b(e,t){var n=[];t.sort((function(e,t){return e.name.localeCompare(t.name)}));var r,o=v(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,i=(0,l.fromApiContact)(a),s=i.userId?i.userId:i.id;e.contacts.items.set(s,i),n.push(i)}}catch(e){o.e(e)}finally{o.f()}return n}function _(e,t){var n,r=[],o=v(t);try{var a=function(){var t=n.value,o=(0,u.fromApiFolder)(t);if(e.organisers.folders.find((function(e){return e.id===o.id})))return r.push(o),"continue";e.organisers.folders.push(o),r.push(o)};for(o.s();!(n=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return r}function w(e,t){var n,r=t.apiChannels,o=t.apiGroups,a=t.dangerouslyMerge,s=[],c=v(r||[]);try{var l=function(){var t=n.value,r=o.find((function(e){return-e.id===t.channel.channel_id}));if(!r)throw new Error("С бэка не приходит нужная группа для канала");var c=(0,d.fromApiChannel)(t,r);(t.last_message&&(0,f.fromApiPost)(t.last_message).reactions||[]).forEach((function(t){e.reactions.set(t.id,t)}));var l=e.channels.get(c.id);if(l&&!a)return s.push(l),"continue";var u=l?i.merge(l,c):c;e.channels.set(u.id,u),s.push(u)};for(c.s();!(n=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}return s}function k(e){return o.isGroupPeerId(e)?o.toRealId(e):0}function C(e,t,n){var o,a,i=e.organisers.folders.find((function(e){return e.id===t}));if(i){var c,l=null!==(o=i.unreadCount)&&void 0!==o?o:0,u=null!==(a=i.unreadUnmutedCount)&&void 0!==a?a:0,d=v(n);try{for(d.s();!(c=d.n()).done;){var f=c.value;r.isInFolder(f,t)&&(r.removeFolder(f,t),s.refresh(e.organisers.folders,f),f.unreadCount&&(r.isMuted(f)?l--:u--))}}catch(e){d.e(e)}finally{d.f()}s.setUnreadCounters(e.organisers.folders,t,l,u)}}function E(e,t,n){var o,a,i=[],c=e.organisers.folders.find((function(e){return e.id===t}));if(c){var l,u=null!==(o=c.unreadCount)&&void 0!==o?o:0,d=null!==(a=c.unreadUnmutedCount)&&void 0!==a?a:0,f=v(n);try{for(f.s();!(l=f.n()).done;){var p=l.value;r.isInFolder(p,t)||(r.addFolder(p,t),i.push(p),p.unreadCount&&(r.isMuted(p)?u++:d++))}}catch(e){f.e(e)}finally{f.f()}s.push(e.organisers.folders,t,"all",i,c.all.hasMore),s.push(e.organisers.folders,t,"unread",i.filter((function(e){return r.isUnread(e)})),c.unread.hasMore),s.setUnreadCounters(e.organisers.folders,t,u,d)}}function A(e,t){return t.reduce((function(t,n){var r=e.convos.get(o.resolveId(n));return r&&t.push(r),t}),[])}},20700:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var i=o.apply(null,n);i&&e.push(i)}}else if("object"===a)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&e.push(s);else e.push(n.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},8994:(e,t,n)=>{"use strict";n.d(t,{nanoid:()=>r});let r=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"")},67075:function(e,t,n){!function(e,t){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var r=n(t);function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}var i=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length||e.some((function(e,n){return!Object.is(e,t[n])}))},s={error:null},c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).state=s,t.resetErrorBoundary=function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.reset()},t}a(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var n=t.prototype;return n.reset=function(){this.setState(s)},n.componentDidCatch=function(e,t){var n,r;null==(n=(r=this.props).onError)||n.call(r,e,t)},n.componentDidUpdate=function(e,t){var n,r,o=this.state.error,a=this.props.resetKeys;null!==o&&null!==t.error&&i(e.resetKeys,a)&&(null==(n=(r=this.props).onResetKeysChange)||n.call(r,e.resetKeys,a),this.reset())},n.render=function(){var e=this.state.error,t=this.props,n=t.fallbackRender,o=t.FallbackComponent,a=t.fallback;if(null!==e){var i={error:e,resetErrorBoundary:this.resetErrorBoundary};if(r.isValidElement(a))return a;if("function"==typeof n)return n(i);if(o)return r.createElement(o,i);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(r.Component);function l(e,t){var n=function(n){return r.createElement(c,t,r.createElement(e,n))},o=e.displayName||e.name||"Unknown";return n.displayName="withErrorBoundary("+o+")",n}function u(e){var t=r.useState(null),n=t[0],o=t[1];if(null!=e)throw e;if(null!=n)throw n;return o}e.ErrorBoundary=c,e.useErrorHandler=u,e.withErrorBoundary=l,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(67294))}}]);try{stManager.done("dist/11c7a0efa74f6d488cf4ce0ffbe4d05a.b7fa677bc26d5ce62438.js")}catch(e){}